--- START OF FILE ai_studio_code (100).html ---

<!-- ROYAL CUPS 8K - COMPACT PRO MAX EDITION (FIXED BACKGROUND & CURRENCY FLOW) -->
<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"><title>Royal Cups 8K - Ultra HD</title><style>@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800;900&display=swap');html,body{width:100%;height:100%;margin:0;overflow:hidden;background:#050505;font-family:'Montserrat',sans-serif;user-select:none;-webkit-user-select:none;touch-action:manipulation;cursor:default}canvas{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1;image-rendering:high-quality}.ptr{pointer-events:auto!important;cursor:pointer;touch-action:manipulation}#no-internet{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.98);z-index:99999;display:none;flex-direction:column;align-items:center;justify-content:center;text-align:center}.net-icon{font-size:60px;margin-bottom:20px;animation:pulseRed 1s infinite}.net-msg{color:#ff3333;font-size:24px;font-weight:900;text-transform:uppercase;letter-spacing:2px}@keyframes pulseRed{0%{opacity:1;transform:scale(1)}50%{opacity:0.5;transform:scale(0.9)}100%{opacity:1;transform:scale(1)}}#loader{position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at center,#1a001a,#000);z-index:20000;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:opacity 0.5s ease-out;pointer-events:auto;overflow:hidden}.pro-coin-container{position:relative;width:260px;height:260px;margin-bottom:50px;display:flex;align-items:center;justify-content:center;animation:floatEmblem 4s ease-in-out infinite}@keyframes floatEmblem{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}.magic-shockwave{position:absolute;width:250px;height:250px;border-radius:50%;border:2px solid rgba(200,50,255,0.3);box-shadow:0 0 20px rgba(180,0,255,0.4),inset 0 0 20px rgba(180,0,255,0.2);animation:pulseShock 0.2s infinite alternate}@keyframes pulseShock{0%{opacity:0.6;transform:scale(1)}100%{opacity:1;transform:scale(1.02);box-shadow:0 0 40px rgba(200,50,255,0.8)}}.electric-ring{position:absolute;width:200px;height:200px;border-radius:50%;border:2px dashed #ff00ff;box-shadow:0 0 15px #9d00ff,inset 0 0 15px #9d00ff;filter:drop-shadow(0 0 5px #ff00ff);animation:spinElectric 6s linear infinite,electricZap 2s infinite}@keyframes spinElectric{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes electricZap{0%,90%{opacity:1;border-color:#ff00ff}92%{opacity:0.5;border-color:#fff}94%{opacity:1;border-color:#ff00ff}96%{opacity:0.3;border-color:#fff}100%{opacity:1;border-color:#ff00ff}}.rune-svg-outer{position:absolute;width:230px;height:230px;animation:spinRunes 20s linear infinite}.rune-svg-inner{position:absolute;width:185px;height:185px;animation:spinRunes 15s linear infinite reverse}@keyframes spinRunes{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.rune-text{fill:#eebbff;font-family:'Courier New',monospace;font-weight:bold;font-size:14px;letter-spacing:4px;text-shadow:0 0 5px #b026ff}.inner-glow-ring{position:absolute;width:164px;height:164px;border-radius:50%;border:2px solid rgba(255,215,0,0.6);box-shadow:0 0 30px rgba(160,0,255,0.8),inset 0 0 20px rgba(160,0,255,0.5)}.pro-coin{position:relative;z-index:5;width:160px;height:160px;border-radius:50%;background:radial-gradient(circle at 30% 30%,#ffd700,#b8860b,#5c4004);border:4px solid #ffd700;box-shadow:inset 0 0 20px rgba(0,0,0,0.5),0 0 10px rgba(0,0,0,0.8);display:flex;flex-direction:column;align-items:center;justify-content:center}.pro-coin::after{content:'';position:absolute;top:8px;left:8px;right:8px;bottom:8px;border-radius:50%;border:2px dashed rgba(184,134,11,0.6);pointer-events:none}.coin-crown{font-size:65px;line-height:1;margin-bottom:2px;background:linear-gradient(180deg,#fff 10%,#FFD700 40%,#aa7700 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;filter:drop-shadow(0 4px 2px rgba(0,0,0,0.6));transform:translateY(-5px) scale(1.1)}.coin-text{font-size:20px;font-weight:900;color:#5c4004;letter-spacing:2px;text-transform:uppercase;text-shadow:1px 1px 0px rgba(255,255,255,0.4),-1px -1px 0px rgba(0,0,0,0.2)}.loader-title{white-space:nowrap;font-size:42px;font-weight:900;font-style:italic;color:#FFD700;text-align:center;margin-bottom:5px;letter-spacing:-1px;text-transform:uppercase;transform:skewX(-12deg);background:linear-gradient(180deg,#fff 10%,#FFD700 50%,#b8860b 90%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;filter:drop-shadow(0 0 20px rgba(255,215,0,0.4));z-index:10}.loader-sub{color:#d050ff;font-size:10px;letter-spacing:6px;text-transform:uppercase;margin-bottom:60px;font-weight:bold;margin-top:5px;text-shadow:0 0 10px #9d00ff}.loading-area{position:absolute;bottom:60px;width:80%;max-width:500px;display:flex;flex-direction:column}.bar-track{width:100%;height:32px;background:#0a000a;border:2px solid #FFD700;border-radius:20px;position:relative;box-shadow:inset 0 0 15px #000, 0 0 10px rgba(255,215,0,0.2);padding:2px;overflow:visible;transition:all 0.2s}.track-warning{animation:redAlert 0.3s infinite alternate}@keyframes redAlert{0%{border-color:#ff0000;box-shadow:0 0 10px #ff0000,0 0 30px #ff0000}100%{border-color:#550000;box-shadow:0 0 5px #550000}}#bar-fill{width:0%;height:100%;background:linear-gradient(90deg,#ffd700,#ffaa00);border-radius:20px;position:relative;box-shadow:0 0 15px #ffd700,0 0 30px #ffaa00;transition:width 0.1s linear}#bar-head-wrap{position:absolute;top:50%;right:-16px;transform:translateY(-50%);width:36px;height:36px;z-index:5}#bar-head-coin{width:100%;height:100%;border-radius:50%;background:radial-gradient(circle,#ffd700,#b8860b);border:2px solid #fff;outline:2px solid gold;outline-offset:2px;box-shadow:0 0 15px gold,0 0 30px #ffaa00;animation:spinFast 0.8s linear infinite;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:900;color:#3d2616;text-shadow:0px 1px 0px rgba(255,255,255,0.5)}.spark{position:absolute;width:10px;height:4px;background:#fff;pointer-events:none;z-index:20005;box-shadow:0 0 8px #fff,0 0 15px #ffcc00,0 0 25px #ffaa00;border-radius:2px;filter:brightness(2)}.text-container{width:100%;display:flex;justify-content:flex-end;margin-top:10px}#loader-text{color:#FFD700;font-size:18px;font-weight:900}@keyframes spinFast{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes flashIn{0%{opacity:1}100%{opacity:0}}.flash-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:#fff;z-index:21000;pointer-events:none;opacity:0;display:none}#menu{position:absolute;width:100%;height:100%;background:radial-gradient(circle at center,#1a1a00,#000);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:6000;overflow:hidden;display:none;opacity:1;pointer-events:auto}.fall-item{position:absolute;top:-10%;animation:fallDown 5s linear infinite;z-index:0;opacity:0.8;font-size:28px;text-shadow:0 0 10px currentColor}@keyframes fallDown{0%{transform:translateY(0) rotate(0deg);opacity:0}10%{opacity:1}100%{transform:translateY(110vh) rotate(360deg);opacity:0}}.casino-frame{position:absolute;width:90%;height:88%;top:6%;border:1px solid rgba(255,215,0,0.3);border-radius:50px;pointer-events:none;z-index:1;box-shadow:0 0 50px rgba(255,215,0,0.1)}.casino-corner{position:absolute;width:60px;height:60px;border-top:3px solid #FFD700;border-left:3px solid #FFD700;border-radius:20px 0 0 0;top:-2px;left:-2px;filter:drop-shadow(0 0 5px #FFD700);pointer-events:none}.c-tr{transform:rotate(90deg);left:auto;right:-2px}.c-br{transform:rotate(180deg);top:auto;bottom:-2px;left:auto;right:-2px}.c-bl{transform:rotate(270deg);top:auto;bottom:-2px}.curved-title-box{width:380px;height:160px;position:relative;z-index:2;margin-top:40px;pointer-events:none}.curved-text{fill:#FFD700;font-size:28px;font-weight:900;letter-spacing:3px;text-transform:uppercase;filter:drop-shadow(0 0 8px gold);pointer-events:none}.main-title{color:#FFD700;font-size:52px;font-weight:900;line-height:0.9;text-align:center;margin:0 0 50px 0;z-index:2;text-shadow:0 0 15px rgba(255,215,0,0.8);background:linear-gradient(180deg,#fff,#FFD700,#b8860b);-webkit-background-clip:text;-webkit-text-fill-color:transparent;pointer-events:none}.sub-title{font-size:65px;display:block;margin-top:5px;pointer-events:none}.btn{padding:18px 0;border-radius:50px;font-weight:900;font-size:20px;text-transform:uppercase;border:none;margin:0 auto 20px;display:block;width:85%;max-width:300px;position:relative;z-index:10;background:linear-gradient(90deg,#FFD700,#FFAA00);color:#000;box-shadow:0 5px 20px rgba(255,215,0,0.3);letter-spacing:1px;transition:transform 0.1s;pointer-events:auto;cursor:pointer}.btn:active{transform:scale(0.96)}#btnSet{position:absolute;top:20px;right:25px;width:50px;height:50px;background:rgba(0,0,0,0.6);border:2px solid #FFD700;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:26px;color:#FFD700;z-index:9999;pointer-events:auto;cursor:pointer;animation:glowGold 2s infinite}#btnDaily{position:absolute;top:80px;right:25px;width:50px;height:50px;background:rgba(0,0,0,0.6);border:2px solid #00ff00;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;color:#00ff00;z-index:9999;pointer-events:auto;cursor:pointer;animation:glowGreen 2s infinite}#btnMission{position:absolute;top:140px;right:25px;width:50px;height:50px;background:rgba(0,0,0,0.6);border:2px solid #ff3333;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;color:#ff3333;z-index:9999;pointer-events:auto;cursor:pointer;animation:glowRed 2s infinite}#btnExchange{position:absolute;top:200px;right:25px;width:50px;height:50px;background:rgba(0,0,0,0.6);border:2px solid #00ccff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;color:#00ccff;z-index:9999;pointer-events:auto;cursor:pointer;animation:glowCyan 2s infinite}#btnProfile{position:absolute;top:85px;left:25px;width:50px;height:50px;background:rgba(0,0,0,0.6);border:2px solid #00ccff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;color:#00ccff;z-index:9999;pointer-events:auto;cursor:pointer;animation:glowBlue 2s infinite;overflow:hidden;}#btnProfile img{width:100%;height:100%;object-fit:cover;}@keyframes glowBlue{0%{box-shadow:0 0 0 0 rgba(0,204,255,0.6)}70%{box-shadow:0 0 0 10px rgba(0,204,255,0)}100%{box-shadow:0 0 0 0 rgba(0,204,255,0)}}@keyframes glowCyan{0%{box-shadow:0 0 0 0 rgba(0,255,255,0.6)}70%{box-shadow:0 0 0 10px rgba(0,255,255,0)}100%{box-shadow:0 0 0 0 rgba(0,255,255,0)}}.notif-dot{position:absolute;top:0;right:0;width:12px;height:12px;background:#ff0000;border:2px solid #fff;border-radius:50%;z-index:10000;display:none;pointer-events:none}@keyframes glowGold{0%{box-shadow:0 0 0 0 rgba(255,215,0,0.6)}70%{box-shadow:0 0 0 10px rgba(255,215,0,0)}100%{box-shadow:0 0 0 0 rgba(255,215,0,0)}}@keyframes glowGreen{0%{box-shadow:0 0 0 0 rgba(0,255,0,0.6)}70%{box-shadow:0 0 0 10px rgba(0,255,0,0)}100%{box-shadow:0 0 0 0 rgba(0,255,0,0)}}@keyframes glowRed{0%{box-shadow:0 0 0 0 rgba(255,51,51,0.6)}70%{box-shadow:0 0 0 10px rgba(255,51,51,0)}100%{box-shadow:0 0 0 0 rgba(255,51,51,0)}}#settings{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);z-index:9000;display:none;align-items:center;justify-content:center}.set-box{width:90%;max-width:400px;background:#050505;border-radius:15px;border:1px solid #333;box-shadow:0 0 50px #000;overflow:hidden;display:flex;flex-direction:column}.set-head{background:#000;padding:15px;text-align:center;font-size:18px;font-weight:900;color:#fff;border-bottom:1px solid #222;letter-spacing:1px;text-transform:uppercase}.set-body{padding:15px;overflow-y:auto;max-height:60vh}.set-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:15px}.set-col{display:flex;flex-direction:column;width:80%}.set-label{color:#FFD700;font-size:11px;font-weight:900;text-transform:uppercase;margin-bottom:5px;display:flex;justify-content:space-between}.set-label span{color:#fff}input[type=range]{-webkit-appearance:none;width:100%;background:transparent}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;height:16px;width:16px;border-radius:50%;background:#FFD700;cursor:pointer;margin-top:-6px;box-shadow:0 0 5px #FFD700}input[type=range]::-webkit-slider-runnable-track{width:100%;height:4px;cursor:pointer;background:#333;border-radius:2px}.play-icon{width:30px;height:30px;border-radius:50%;border:1px solid #444;background:#111;color:#888;display:flex;align-items:center;justify-content:center;font-size:10px;cursor:pointer;margin-left:10px}.btn-reset{width:100%;padding:12px;background:#990000;color:#fff;font-weight:800;font-size:12px;border:none;border-radius:8px;margin-bottom:10px;display:flex;align-items:center;justify-content:center;gap:8px;box-shadow:0 3px 0 #550000;text-transform:uppercase}.btn-free{width:100%;padding:14px;background:linear-gradient(135deg,#1e004d,#001f4d);color:#aaa;font-weight:900;font-size:13px;border:1px solid #333;border-radius:10px;margin-bottom:5px;display:flex;align-items:center;justify-content:center;gap:8px;box-shadow:0 4px 10px rgba(0,0,0,0.5);text-transform:uppercase;letter-spacing:1px;transition:all 0.3s}.btn-free.active{background:linear-gradient(135deg,#a200ff,#00ccff);color:#fff;cursor:pointer;border:1px solid #fff;box-shadow:0 0 15px rgba(0,200,255,0.6);animation:pulseFree 2s infinite}@keyframes pulseFree{0%{box-shadow:0 0 10px rgba(162,0,255,0.4)}50%{box-shadow:0 0 25px rgba(0,204,255,0.8)}100%{box-shadow:0 0 10px rgba(162,0,255,0.4)}}.set-foot{padding:15px;background:#080808;display:flex;justify-content:center;border-top:1px solid #222}.s-close{width:100%;padding:12px;background:#333;border:1px solid #555;border-radius:8px;font-weight:900;font-size:13px;color:#fff;cursor:pointer;text-transform:uppercase}#shop{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.96);z-index:7000;display:none;flex-direction:column;align-items:center;padding-top:20px;pointer-events:auto;overflow-y:auto;will-change:scroll-position}.grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;width:95%;max-width:600px;padding-bottom:50px}.item{background:#181818;border:2px solid #333;border-radius:15px;padding:8px;text-align:center;transition:background .2s;position:relative;overflow:hidden}.item.act{border-color:#FFD700;background:rgba(255,215,0,.15)}.item.lck{opacity:0.7;filter:grayscale(0.8)}.prev{width:100%;height:70px;border-radius:10px;margin:0 auto 5px;background-size:cover;background-repeat:no-repeat;background-position:center;background-color:#222;box-shadow:0 2px 5px #000;display:flex;align-items:center;justify-content:center;font-weight:bold;color:#fff;font-size:14px;position:relative}.tag{font-size:10px;color:#aaa;margin-top:2px;font-weight:bold;letter-spacing:0.5px}.buy-btn{background:linear-gradient(90deg,#ff3333,#ff6666,#ff3333);background-size:200%;color:#fff;border:2px solid #fff;padding:8px 15px;border-radius:20px;font-size:11px;font-weight:900;margin-top:6px;cursor:pointer;box-shadow:0 0 15px #ff0000;animation:glowingBuy 0.8s infinite alternate;text-shadow:0 0 2px #000}@keyframes glowingBuy{from{box-shadow:0 0 5px #ff0000;transform:scale(1);filter:brightness(1)}to{box-shadow:0 0 25px #ff3333,0 0 10px #fff inset;transform:scale(1.05);filter:brightness(1.3)}}.coin-hud{position:fixed;top:15px;left:25px;padding:10px 20px;background:rgba(20,20,20,0.9);border:2px solid #FFD700;border-radius:25px;color:#FFD700;font-weight:900;font-size:16px;display:flex;align-items:center;gap:8px;box-shadow:0 5px 15px rgba(0,0,0,0.5);z-index:10001;transition:opacity 0.2s}.d-hud{color:#00ccff;margin-left:10px;display:inline-flex;align-items:center}#ui{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:10;display:none;opacity:0}.bet-box{position:absolute;bottom:60px;width:100%;display:flex;justify-content:center;gap:15px;pointer-events:auto;z-index:20000}.b-ctrl{width:55px;height:55px;border-radius:50%;font-size:24px;display:flex;align-items:center;justify-content:center;background:#FFD700;border:3px solid #FFF;box-shadow:0 4px 10px #000;pointer-events:auto;cursor:pointer}.b-play{width:180px;font-size:20px;border:2px solid #FFF;border-radius:40px;padding:12px 0;background:#FFD700;font-weight:900;box-shadow:0 4px 15px rgba(0,0,0,0.5);pointer-events:auto;cursor:pointer}#stats{position:absolute;top:15px;width:100%;display:flex;align-items:center;justify-content:space-between;padding:0 20px;box-sizing:border-box;z-index:20000;pointer-events:auto}.badge{background:rgba(0,0,0,.8);padding:8px 15px;border-radius:12px;border:1px solid #FFD700;color:#FFD700;font-weight:800;cursor:pointer;height:40px;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;vertical-align:middle}#win,#lose{position:absolute;top:0;left:0;width:100%;height:100%;display:none;flex-direction:column;align-items:center;justify-content:center;z-index:5000;pointer-events:auto;opacity:0}#win{background:radial-gradient(circle,rgba(0,20,40,.95),#000)}#lose{background:radial-gradient(circle,rgba(60,0,0,.95),#000)}.win-top{color:#00E5FF;font-size:20px;font-weight:800;letter-spacing:4px;margin-bottom:5px;text-shadow:0 0 10px rgba(0,229,255,0.8)}.win-main{color:#fff;font-size:42px;font-weight:900;margin-bottom:5px;text-transform:uppercase;font-style:italic;text-shadow:0 0 20px rgba(255,255,255,0.5)}.win-amt{color:#FFD700;font-size:32px;font-weight:900;margin-bottom:25px;text-shadow:0 2px 15px rgba(255,215,0,0.6)}.trophy-box{position:relative;width:250px;height:250px;display:flex;align-items:center;justify-content:center;margin-bottom:20px;perspective:1000px}.glow{position:absolute;width:180px;height:180px;background:radial-gradient(circle,rgba(255,215,0,0.3),transparent 70%);filter:blur(20px)}.ring{position:absolute;border-radius:50%;border:2px solid transparent}.r1{width:90%;height:90%;border-top:2px solid #FFD700;border-bottom:2px solid #FFD700;animation:spin 8s linear infinite;box-shadow:0 0 10px #FFD700;opacity:0.7}.r2{width:100%;height:100%;border-left:1px solid #fff;border-right:1px solid #fff;animation:spinRev 12s linear infinite;opacity:.3}.trophy{font-size:120px;filter:drop-shadow(0 0 20px rgba(255,215,0,0.4));position:relative;z-index:10;transform-style:preserve-3d}.lose-box{background:rgba(0,0,0,0.95);border:3px solid red;padding:40px 20px;border-radius:25px;text-align:center;width:85%;max-width:450px;box-shadow:0 0 50px rgba(255,0,0,0.4);display:flex;flex-direction:column;gap:20px}.lose-title{color:red;font-size:48px;margin:0 0 10px;font-weight:900;text-shadow:0 0 20px rgba(255,0,0,0.8)}.lose-btn{width:100%;font-size:20px;padding:18px;margin:0}#unlock-screen{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);z-index:9000;display:none;align-items:center;justify-content:center;flex-direction:column}.unlock-card{width:240px;padding:20px;background:linear-gradient(145deg,#111,#000);border:2px solid #FFD700;border-radius:20px;text-align:center;box-shadow:0 0 40px rgba(255,215,0,0.3);display:flex;flex-direction:column;align-items:center;animation:popIn 0.3s cubic-bezier(0.175,0.885,0.32,1.275)}.unlock-header{color:#FFD700;font-size:14px;font-weight:800;letter-spacing:1px;margin-bottom:15px;text-transform:uppercase}.unlock-preview{width:100px;height:100px;border-radius:50%;margin-bottom:15px;background:radial-gradient(#333,#000);border:2px solid #333;display:flex;align-items:center;justify-content:center;box-shadow:inset 0 0 15px rgba(0,0,0,0.8)}.unlock-name{color:#fff;font-size:18px;font-weight:900;margin-bottom:20px;text-transform:uppercase}.unlock-btn{background:linear-gradient(90deg,#FFD700,#ffaa00);color:#000;width:100%;padding:12px;font-size:14px;border:none;border-radius:12px;font-weight:900;cursor:pointer;box-shadow:0 4px 10px rgba(255,215,0,0.2)}#daily-screen,#mission-screen,#profile-screen,#name-screen,#avatar-screen{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);z-index:9500;display:none;align-items:center;justify-content:center;flex-direction:column;will-change:opacity}.daily-box{width:90%;max-width:420px;max-height:80vh;padding:15px 20px;display:flex;flex-direction:column;align-items:center;position:relative;background:linear-gradient(180deg,#3d2616 0%,#1a0b05 60%,#050200 100%);border:2px solid #dcb562;border-radius:20px;box-shadow:0 0 40px rgba(0,0,0,0.8),inset 0 0 30px rgba(200,150,50,0.1);overflow-y:auto;box-sizing:border-box}.daily-box::-webkit-scrollbar{display:none}.daily-box{-ms-overflow-style:none;scrollbar-width:none}.daily-box-top-text{color:#ccaa66;font-size:11px;text-transform:uppercase;letter-spacing:2px;margin-bottom:5px;font-weight:700}.daily-head{background:linear-gradient(180deg,#fff 20%,#ffdf80 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-size:26px;font-weight:900;margin:0 0 25px;text-transform:uppercase;letter-spacing:1px;text-shadow:0 2px 10px rgba(0,0,0,0.5)}.close-icon-btn{font-size:24px;color:#888;cursor:pointer;transition:color 0.3s}.close-icon-btn:hover{color:#fff}.daily-close{width:150px;padding:10px;margin-top:20px;background:linear-gradient(180deg,#2a2a2a,#111);border:1px solid #444;border-radius:20px;color:#aaa;font-weight:800;text-transform:uppercase;font-size:12px;cursor:pointer}#exchange-screen{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.98);z-index:9500;display:none;align-items:center;flex-direction:column;will-change:opacity;overflow-y:auto;padding-top:80px;justify-content:flex-start}.ex-header-container{display:flex;flex-direction:column;align-items:center;margin-bottom:30px;flex-shrink:0}.ex-crown{font-size:50px;filter:drop-shadow(0 0 15px gold);animation:floatEmblem 3s ease-in-out infinite}.ex-main-title{color:#ffaa55;font-size:22px;font-weight:900;letter-spacing:2px;text-transform:uppercase;text-shadow:0 0 10px rgba(255,100,0,0.6);margin-top:5px}.ex-cards-container{display:flex;flex-wrap:wrap;gap:15px;width:95%;max-width:600px;justify-content:center;padding-bottom:20px}.ex-card{flex:1 1 250px;max-width:300px;min-width:250px;background:#050505;border:2px solid #00ccff;border-radius:15px;padding:20px 10px;display:flex;flex-direction:column;align-items:center;box-shadow:0 0 25px rgba(0,204,255,0.5),inset 0 0 10px rgba(0,204,255,0.2);position:relative;animation:cardGlow 3s infinite alternate}@keyframes cardGlow{from{box-shadow:0 0 15px rgba(0,204,255,0.3)}to{box-shadow:0 0 30px rgba(0,204,255,0.8)}}.ex-card-title{color:#fff;font-weight:800;font-size:14px;text-transform:uppercase;margin-bottom:20px;letter-spacing:0.5px}.ex-icon-row{display:flex;align-items:center;gap:10px;margin-bottom:20px}.ex-big-icon{font-size:35px;filter:drop-shadow(0 0 8px rgba(255,255,255,0.4))}.ex-arrow{font-size:20px;color:#555;background:#222;border-radius:5px;padding:2px 6px}.ex-input-group{display:flex;align-items:center;gap:8px;width:100%;justify-content:center;margin-bottom:20px}.ex-btn-ctrl{width:30px;height:30px;border-radius:50%;background:#222;border:1px solid #444;color:#888;font-size:18px;font-weight:bold;display:flex;align-items:center;justify-content:center;cursor:pointer}.ex-btn-ctrl:active{background:#333;color:#fff}.ex-display-val{background:#000;border:1px solid #333;border-radius:8px;color:#fff;font-weight:900;font-size:16px;padding:8px 0;width:80px;text-align:center}.ex-action-btn{width:90%;padding:12px 0;border-radius:8px;border:none;background:linear-gradient(90deg,#00ccff,#0088ff);color:#fff;font-weight:900;font-size:14px;text-transform:uppercase;box-shadow:0 0 15px rgba(0,204,255,0.5);cursor:pointer}.ex-action-btn:active{transform:scale(0.95)}.top-balance-pill{position:absolute;top:15px;left:50%;transform:translateX(-50%);display:flex;align-items:center;gap:15px;border:2px solid #FFD700;border-radius:30px;padding:8px 25px;background:#111;box-shadow:0 0 15px rgba(255,215,0,0.3);z-index:100}.tb-item{display:flex;align-items:center;gap:5px;color:#FFD700;font-weight:900;font-size:16px}.tb-dia{color:#00ccff}.ex-top-glow{position:fixed;top:30%;width:100%;height:2px;background:linear-gradient(90deg,transparent,#ff0055,transparent);box-shadow:0 0 20px #ff0055;pointer-events:none;opacity:0.5}.bottom-close-btn{position:relative;bottom:auto;width:150px;padding:12px;background:#222;border:1px solid #444;color:#fff;font-weight:900;border-radius:20px;z-index:9999;cursor:pointer;box-shadow:0 5px 15px #000;margin-bottom:40px;margin-top:10px;flex-shrink:0}.ex-feedback{font-size:12px;font-weight:900;margin-top:10px;text-transform:uppercase;letter-spacing:1px;padding:5px 10px;border-radius:5px;background:rgba(0,0,0,0.5);border:1px solid #333}.close-ex-abs{position:fixed;top:20px;right:20px;color:#fff;font-size:28px;cursor:pointer;z-index:101;background:rgba(0,0,0,0.5);width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;border:1px solid #444}.mission-row{width:100%;margin-bottom:12px;padding:12px 15px;box-sizing:border-box;background:linear-gradient(90deg,rgba(40,20,10,0.6) 0%,rgba(20,10,5,0.8) 100%);border:1px solid #664422;border-radius:12px;box-shadow:0 4px 8px rgba(0,0,0,0.3);display:flex;justify-content:space-between;align-items:center;position:relative;overflow:hidden}.mission-row::after{content:'';position:absolute;top:0;left:0;width:100%;height:40%;background:linear-gradient(180deg,rgba(255,255,255,0.03),transparent);pointer-events:none}.m-info{display:flex;flex-direction:column;width:65%;z-index:2}.m-name{color:#eee;font-size:13px;font-weight:800;text-transform:uppercase;letter-spacing:0.5px;margin-bottom:3px}.m-prog{color:#998877;font-size:10px;margin-bottom:6px;font-weight:600}.m-bar-bg{width:100%;height:4px;background:#221105;border-radius:10px;margin-bottom:8px;position:relative;overflow:hidden}.m-bar-fill{height:100%;width:0%;border-radius:10px;background:linear-gradient(90deg,#ff9900,#ffdd55);box-shadow:0 0 5px rgba(255,150,0,0.5);transition:width 0.5s}.m-rew-box{display:flex;align-items:center;gap:5px;font-size:11px;font-weight:800;color:#ffbb33}.m-btn{background:transparent;color:#ccc;border:1px solid #666;padding:6px 14px;border-radius:20px;font-weight:700;font-size:11px;transition:0.2s;pointer-events:none;z-index:2;min-width:60px;text-align:center}.m-btn.ready{background:linear-gradient(180deg,#e6b800,#cc7a00);border:1px solid #ffeebb;color:#110000;box-shadow:0 0 10px rgba(255,200,50,0.4);pointer-events:auto;animation:pulseGold 2s infinite;cursor:pointer}.m-btn.done{background:#1a1a1a;color:#555;border-color:#333}@keyframes pulseGold{0%{transform:scale(1)}50%{transform:scale(1.05)}100%{transform:scale(1)}}.daily-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;width:100%;margin-bottom:15px}.day-card{aspect-ratio:1/1.1;background:linear-gradient(145deg,#1f120a,#0d0502);border:1px solid #442211;border-radius:12px;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;box-shadow:inset 0 0 10px rgba(0,0,0,0.5)}.day-card.active{border:1px solid #ffaa00;background:radial-gradient(circle at center,#552b00,#220d00);box-shadow:0 0 10px rgba(255,170,0,0.3);transform:scale(1.03);z-index:5}.day-card.claimed{background:#0f0805;border:1px solid #22110a;opacity:0.6}.d-title{font-size:9px;color:#887766;font-weight:700;margin-bottom:5px;text-transform:uppercase;z-index:2}.day-card.active .d-title{color:#fff}.d-rew{color:#ffcc66;font-weight:900;font-size:11px;z-index:2;text-align:center}.big-reward-box{width:100%;height:90px;border:1px solid #ff9900;border-radius:15px;background:linear-gradient(135deg,#2b1100,#000);display:flex;flex-direction:row;align-items:center;justify-content:space-around;margin-bottom:20px;box-shadow:0 0 15px rgba(255,150,0,0.2);position:relative;overflow:hidden;flex-shrink:0}.daily-claim-btn{width:100%;padding:14px;background:linear-gradient(90deg,#eebb55,#cc8800,#eebb55);background-size:200%;color:#110000;font-weight:900;border:none;border-radius:30px;font-size:15px;cursor:pointer;margin-top:auto;margin-bottom:5px;box-shadow:0 0 15px rgba(255,180,50,0.4);letter-spacing:1px;animation:goldFlow 3s linear infinite;transition:all 0.3s;flex-shrink:0}.daily-claim-btn:active{transform:scale(0.92);filter:brightness(0.8)}.daily-claim-btn:disabled{background:#221105;color:#554433;box-shadow:none;animation:none;cursor:not-allowed;border:1px solid #332211;transform:none}.fly-coin, .fly-diamond {position: fixed;width: 24px;height: 24px;border: 2px solid #fff;border-radius: 50%;z-index: 99999;pointer-events: none;font-size: 12px;display: flex;align-items: center;justify-content: center;font-weight: 900;will-change: transform, opacity;top: 0; left: 0;transform: translate3d(0,0,0);}.fly-coin {background: radial-gradient(circle at 30% 30%,#ffd700,#b8860b);box-shadow: 0 0 15px gold, 0 0 30px #ffaa00;color: #4a3200;}.fly-diamond {background: radial-gradient(circle at 30% 30%,#00ffff,#0088aa);box-shadow: 0 0 15px #00ffff, 0 0 30px #00ccff;color: #000;}.confetti{position:fixed;width:8px;height:8px;background:#fff;z-index:99998;pointer-events:none;border-radius:2px}.stat-grid{display:grid;grid-template-columns:1fr 1fr;gap:15px;width:100%;margin-top:15px;flex-shrink:0}.stat-card{padding:15px;border-radius:12px;text-align:center}.stat-card:nth-child(1){background:linear-gradient(145deg,#001a33,#000);border:1px solid #00ccff;box-shadow:0 0 15px rgba(0,204,255,0.3)}.stat-card:nth-child(2){background:linear-gradient(145deg,#003300,#000);border:1px solid #00ff00;box-shadow:0 0 15px rgba(0,255,0,0.3)}.stat-card:nth-child(3){background:linear-gradient(145deg,#330033,#000);border:1px solid #ff00ff;box-shadow:0 0 15px rgba(255,0,255,0.3)}.stat-card:nth-child(4){background:linear-gradient(145deg,#332200,#000);border:1px solid #ffd700;box-shadow:0 0 15px rgba(255,215,0,0.3)}.stat-val{color:#fff;font-size:20px;font-weight:900}.stat-lbl{color:#888;font-size:10px;text-transform:uppercase;margin-top:5px;letter-spacing:1px}.trail-dot{position:absolute;width:6px;height:6px;background:gold;border-radius:50%;pointer-events:none;z-index:999999;opacity:1;box-shadow:0 0 5px gold}.box-timer{font-size:10px;color:#fff;font-weight:bold;background:rgba(0,0,0,0.5);padding:2px 6px;border-radius:4px;margin-top:4px}.name-input{width:80%;padding:12px;background:#111;border:1px solid #444;border-radius:8px;color:#fff;font-size:16px;margin-bottom:20px;text-align:center;font-weight:bold}.name-btn-row{display:flex;gap:10px;width:80%}.btn-save{flex:1;padding:12px;background:#00ccff;border:none;border-radius:8px;color:#000;font-weight:900;cursor:pointer}.btn-skip{flex:1;padding:12px;background:#333;border:1px solid #555;border-radius:8px;color:#aaa;font-weight:900;cursor:pointer}.avatar-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;width:100%;margin-top:15px;max-height:50vh;overflow-y:auto;padding:5px}.avatar-item{aspect-ratio:1;border-radius:12px;border:2px solid #444;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:35px;cursor:pointer;box-shadow:0 0 10px rgba(0,0,0,0.5);transition:transform 0.2s,border-color 0.2s;position:relative;overflow:hidden;animation:floatAvatar 3s ease-in-out infinite}.avatar-item:nth-child(odd){animation-direction:alternate}.avatar-item:nth-child(even){animation-direction:alternate-reverse}@keyframes floatAvatar{from{transform:translateY(0)}to{transform:translateY(-5px)}}.avatar-item.selected{border-color:#00ff00;box-shadow:0 0 20px #00ff00;z-index:2}.avatar-item::after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,rgba(255,255,255,0.1),transparent);pointer-events:none}.avatar-item img{width:100%;height:100%;object-fit:cover;}.avatar-lock{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);display:flex;flex-direction:column;align-items:center;justify-content:center;color:#fff;font-size:12px;font-weight:bold}.av-price{color:#00ccff;font-size:10px;margin-top:2px}.edit-btn{position:absolute;bottom:0;right:0;width:24px;height:24px;background:#00ccff;border-radius:50%;color:#000;display:flex;align-items:center;justify-content:center;font-size:12px;border:2px solid #fff;z-index:10}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);z-index:22000;display:none;align-items:center;justify-content:center;opacity:0;transition:opacity 0.2s}.modal-box{width:85%;max-width:320px;background:#111;border:2px solid #FFD700;border-radius:20px;padding:25px 20px;text-align:center;box-shadow:0 0 40px rgba(255,215,0,0.4);transform:scale(0.8);transition:transform 0.3s cubic-bezier(0.175,0.885,0.32,1.275)}.modal-title{color:#FFD700;font-size:22px;font-weight:900;margin-bottom:10px;text-transform:uppercase;letter-spacing:1px}.modal-msg{color:#ccc;font-size:14px;margin-bottom:25px;line-height:1.5;font-weight:500}.modal-btns{display:flex;gap:15px;justify-content:center}.m-btn{flex:1;padding:12px;border-radius:12px;font-weight:900;border:none;cursor:pointer;font-size:13px;text-transform:uppercase}.m-btn.cancel{background:#333;color:#aaa;border:1px solid #555}.m-btn.confirm{background:linear-gradient(90deg,#FFD700,#FFAA00);color:#000;box-shadow:0 0 15px gold}.m-btn:active{transform:scale(0.95)}
</style>
</head>
<body>
<div id="no-internet"><div class="net-icon">üì°</div><div class="net-msg">NO INTERNET</div><div class="net-sub">DATA REQUIRED TO PLAY</div></div>
<div class="coin-hud" id="menu-coin">üí∞ <span id="menu-coin-val">5000</span><span class="d-hud">üíé <span id="menu-diamond-val">0</span></span></div>
<div id="loader"><div class="pro-coin-container"><div class="magic-shockwave"></div><div class="electric-ring"></div><svg class="rune-svg-outer" viewBox="0 0 300 300"><defs><path id="circlePathOut" d="M 150, 150 m -115, 0 a 115,115 0 0,1 230,0 a 115,115 0 0,1 -230,0" /></defs><text class="rune-text" fill="#d050ff"><textPath href="#circlePathOut">·ö† ·ö¢ ·ö¶ ·ö® ·ö± ·ö≤ ·ö∫ ·öæ ·õÅ ·õÉ ·õã ·õè ·õí ·õñ ·õó ·õö ·õú ·õû ·õü ·ö† ·ö¢ ·ö¶ ·ö® ·ö± ·ö≤ ·ö∫ ·öæ ·õÅ ·õÉ ·õã ·õè</textPath></text></svg><svg class="rune-svg-inner" viewBox="0 0 300 300"><defs><path id="circlePathIn" d="M 150, 150 m -92, 0 a 92,92 0 0,1 184,0 a 92,92 0 0,1 -184,0" /></defs><text class="rune-text" fill="#e0b0ff" style="font-size: 11px; letter-spacing: 4px;"><textPath href="#circlePathIn">·ö† ·ö¢ ·ö¶ ·ö® ·ö± ·ö≤ ·ö∫ ·öæ ·õÅ ·õÉ ·õã ·õè ·õí ·õñ ·õó ·õö ·õú ·õû ·õü</textPath></text></svg><div class="inner-glow-ring"></div><div class="pro-coin"><div class="coin-crown">‚ôõ</div><div class="coin-text">ROYAL</div></div></div><div class="loader-title">ROYAL CUPS</div><div class="loader-sub">8K EXCHANGE EDITION</div><div class="loading-area"><div class="bar-track"><div id="bar-fill"><div id="bar-head-wrap"><div id="bar-head-coin">RC</div></div></div></div><div class="text-container"><div id="loader-text">0%</div></div></div></div><div id="flash" class="flash-overlay"></div>
<div id="custom-modal" class="modal-overlay"><div class="modal-box"><div class="modal-title" id="modal-title">TITLE</div><div class="modal-msg" id="modal-msg">Message goes here...</div><div class="modal-btns"><button class="m-btn cancel ptr" onclick="closeModal()">CANCEL</button><button class="m-btn confirm ptr" id="modal-confirm-btn">CONFIRM</button></div></div></div>
<div id="menu"><div class="casino-frame"><div class="casino-corner c-tl"></div><div class="casino-corner c-tr"></div><div class="casino-corner c-br"></div><div class="casino-corner c-bl"></div></div><div id="casino-effects"></div><button id="btnProfile" class="ptr" onclick="openProfile()"></button><button id="btnSet" class="ptr" onclick="openSettings()">‚öôÔ∏è</button><button id="btnDaily" class="ptr" onclick="openDaily()">üìÖ</button><button id="btnMission" class="ptr" onclick="openMission()">üéØ<div class="notif-dot" id="msnDot"></div></button><button id="btnExchange" class="ptr" onclick="openExchange()">üí±</button><div class="curved-title-box"><svg viewBox="0 0 600 200" width="100%" height="100%"><path id="curve" d="M 50,180 A 300,300 0 0,1 550,180" fill="transparent"/><text width="600"><textPath href="#curve" startOffset="50%" text-anchor="middle" class="curved-text">ROYAL CUPS 8K ULTIMATE</textPath></text></svg></div><div class="main-title">THIMBLES<br><span class="sub-title">GAME</span></div><button class="btn ptr" onclick="startGame()">START GAME</button><button class="btn ptr" onclick="openShop()">CUPS SKINS</button></div>
<div id="name-screen"><div class="daily-box" style="border-color:#fff;"><div class="daily-head" style="margin-top:20px;">ENTER NAME</div><input type="text" id="name-input" class="name-input" placeholder="Your Name" maxlength="12"><div class="name-btn-row"><button class="btn-save ptr" onclick="saveName()">SAVE</button><button class="btn-skip ptr" onclick="skipName()">SKIP</button></div></div></div>
<div id="profile-screen"><div class="daily-box" style="border-color:#00ccff; box-shadow: 0 0 40px rgba(0,200,255,0.3);"><div style="width:100%; display:flex; justify-content:space-between; align-items:center;"><span class="daily-box-top-text" style="color:#00ccff">PLAYER PROFILE</span><span class="close-icon-btn" onclick="closeProfile()">‚úï</span></div><div class="daily-head" style="background:linear-gradient(180deg, #fff, #00ccff); -webkit-background-clip:text;">MY STATS</div><div style="position:relative; width:80px; height:80px; margin-bottom:10px; flex-shrink:0;"><div id="p-avatar-display" class="ptr" onclick="openAvatarSelect()" style="width:100%; height:100%; border-radius:50%; background:#222; border:2px solid #00ccff; display:flex; align-items:center; justify-content:center; font-size:40px; overflow:hidden;"></div><div class="edit-btn ptr" onclick="openAvatarSelect()">‚úèÔ∏è</div></div><div class="ptr" onclick="openNamePopup()" style="display:flex; align-items:center; gap:8px; cursor:pointer; margin-bottom:5px;"><div id="p-name" style="color:#fff; font-weight:bold; font-size:16px;">GUEST PLAYER</div><span style="font-size:14px;">‚úèÔ∏è</span></div><div style="color:#666; font-size:10px; margin-bottom:20px;">ID: 882910</div><div class="stat-grid"><div class="stat-card"><div class="stat-val" id="p-total">0</div><div class="stat-lbl">Games Played</div></div><div class="stat-card"><div class="stat-val" id="p-win">0</div><div class="stat-lbl">Games Won</div></div><div class="stat-card"><div class="stat-val" id="p-rate" style="color:#00ff00">0%</div><div class="stat-lbl">Win Rate</div></div><div class="stat-card"><div class="stat-val" id="p-bet">0</div><div class="stat-lbl">Highest Bet</div></div></div><button class="daily-close ptr" onclick="closeProfile()">CLOSE</button></div></div>
<div id="avatar-screen"><div class="daily-box" style="border-color:#d050ff;"><div style="width:100%; display:flex; justify-content:space-between; align-items:center;"><span class="daily-box-top-text" style="color:#d050ff">CHOOSE AVATAR</span><span class="close-icon-btn" onclick="closeAvatarSelect()">‚úï</span></div><div class="avatar-grid" id="avatar-grid-container"></div><button class="daily-close ptr" onclick="closeAvatarSelect()">CLOSE</button></div></div>
<div id="daily-screen"><div class="daily-box"><div style="width:100%; display:flex; justify-content:space-between; align-items:center;"><span class="daily-box-top-text">DAILY REWARDS</span><span class="close-icon-btn" onclick="closeDaily()">‚úï</span></div><div class="daily-head">7 DAY STREAK</div><div class="daily-grid" id="daily-grid-main"></div><div class="big-reward-box" id="day-7-box"><div style="display:flex; flex-direction:column; align-items:center; z-index:2;"><div style="color:#d4af37; font-weight:bold; font-size:12px; letter-spacing:2px; margin-bottom:5px;">DAY 7</div><div style="font-size:35px; filter:drop-shadow(0 0 10px rgba(255,200,0,0.8));">üëë</div></div><div style="display:flex; flex-direction:column; align-items:center; z-index:2;"><div style="color:#fff; font-weight:900; font-size:16px; text-shadow:0 0 10px #ff3300;">MYSTERY</div><div style="color:#FFD700; font-weight:900; font-size:16px; text-shadow:0 0 10px gold;">SKIN</div></div></div><button id="claimDailyBtn" class="daily-claim-btn ptr" onclick="claimDaily()">CLAIM REWARD</button></div></div>
<div id="mission-screen"><div class="daily-box"><div style="width:100%; display:flex; justify-content:space-between; align-items:center;"><span class="daily-box-top-text">DAILY QUESTS</span><span class="close-icon-btn" onclick="closeMission()">‚úï</span></div><div class="daily-head">TODAY'S TASKS</div><div id="mission-list" style="width:100%"></div><button class="daily-close ptr" onclick="closeMission()">CLOSE</button></div></div>
<div id="exchange-screen"><div class="ex-top-glow"></div><div class="close-ex-abs ptr" onclick="closeExchange()">‚úï</div><div class="top-balance-pill"><div class="tb-item">üí∞ <span id="ex-h-c">5000</span></div><div class="tb-item tb-dia">üíé <span id="ex-h-d">0</span></div></div><div class="ex-header-container"><div class="ex-crown">üëë</div><div class="ex-main-title">THE ROYAL EXCHANGE</div></div><div class="ex-cards-container"><div class="ex-card"><div class="ex-card-title">GET DIAMONDS</div><div class="ex-icon-row"><div class="ex-big-icon">üí∞</div><div class="ex-arrow">‚û°</div><div class="ex-big-icon">üíé</div></div><div class="ex-input-group"><div class="ex-btn-ctrl ptr" onclick="adjustExVal('L', -1000)">-</div><div class="ex-display-val" id="ex-val-L">7000</div><div class="ex-btn-ctrl ptr" onclick="adjustExVal('L', 1000)">+</div></div><button class="ex-action-btn ptr" onclick="executeExchange('L')">EXCHANGE</button><div class="ex-feedback" style="color:#00ccff; border-color:#0088aa;" id="ex-feed-L">GET: üíé 7</div></div><div class="ex-card"><div class="ex-card-title">GET COINS</div><div class="ex-icon-row"><div class="ex-big-icon">üíé</div><div class="ex-arrow">‚û°</div><div class="ex-big-icon">üí∞</div></div><div class="ex-input-group"><div class="ex-btn-ctrl ptr" onclick="adjustExVal('R', -10)">-</div><div class="ex-display-val" id="ex-val-R">30</div><div class="ex-btn-ctrl ptr" onclick="adjustExVal('R', 10)">+</div></div><button class="ex-action-btn ptr" onclick="executeExchange('R')">EXCHANGE</button><div class="ex-feedback" style="color:#FFD700; border-color:#aa8800;" id="ex-feed-R">GET: üí∞ 30000</div></div></div><button class="bottom-close-btn ptr" onclick="closeExchange()">CLOSE</button></div>
<div id="settings"><div class="set-box"><div class="set-head">AUDIO SETTINGS</div><div class="set-body"><div class="set-row"><div class="set-col"><div class="set-label">CLICK SOUND <span id="val-ui">80</span></div><input type="range" id="rng-ui" min="0" max="100" value="80" oninput="updVol('ui',this.value)"></div><button class="play-icon ptr" onclick="tstVol('ui')">‚ñ∂</button></div><div class="set-row"><div class="set-col"><div class="set-label">MENU SOUND <span id="val-home">80</span></div><input type="range" id="rng-home" min="0" max="100" value="80" oninput="updVol('home',this.value)"></div><button class="play-icon ptr" onclick="tstVol('home')">‚ñ∂</button></div><div class="set-row"><div class="set-col"><div class="set-label">GAME CUPS SOUND <span id="val-shuffle">80</span></div><input type="range" id="rng-shuffle" min="0" max="100" value="80" oninput="updVol('shuffle',this.value)"></div><button class="play-icon ptr" onclick="tstVol('shuffle')">‚ñ∂</button></div><div class="set-row"><div class="set-col"><div class="set-label">WINNING SOUND <span id="val-win">65</span></div><input type="range" id="rng-win" min="0" max="100" value="65" oninput="updVol('win',this.value)"></div><button class="play-icon ptr" onclick="tstVol('win')">‚ñ∂</button></div><div class="set-row"><div class="set-col"><div class="set-label">FIELD SOUND <span id="val-wrong">80</span></div><input type="range" id="rng-wrong" min="0" max="100" value="80" oninput="updVol('wrong',this.value)"></div><button class="play-icon ptr" onclick="tstVol('wrong')">‚ñ∂</button></div><div class="set-row"><div class="set-col"><div class="set-label">CUPS CLICK SOUND <span id="val-lift">80</span></div><input type="range" id="rng-lift" min="0" max="100" value="80" oninput="updVol('lift',this.value)"></div><button class="play-icon ptr" onclick="tstVol('lift')">‚ñ∂</button></div><div class="set-row"><div class="set-col"><div class="set-label">MUSIC SOUND <span id="val-bg">50</span></div><input type="range" id="rng-bg" min="0" max="100" value="50" oninput="updVol('bg',this.value)"></div><button class="play-icon ptr" onclick="tstVol('bg')">‚ñ∂</button></div><div class="set-row"><div class="set-col"><div class="set-label">VIBRATION STRENGTH <span id="val-vib">100</span></div><input type="range" id="rng-vib" min="0" max="100" value="100" oninput="updVol('vib',this.value)"></div><button class="play-icon ptr" onclick="triggerVib('heavy')">‚ö°</button></div></div><div class="set-head" style="border-top:1px solid #222; border-bottom:none; margin-top:0;">GAME DATA</div><div style="padding:0 20px 20px 20px; display:flex; flex-direction:column;"><button class="btn-reset ptr" onclick="doReset()">üî¥ RESET FULL GAME</button><button id="btnFree" class="btn-free ptr" onclick="doFreeCoins()">üíé EMERGENCY COINS</button><div style="color:#555; font-size:10px; text-align:center; margin-top:5px;">*Available when balance < 500</div></div><div class="set-foot"><button class="s-close ptr" onclick="closeSettings()">CLOSE</button></div></div></div>
<div id="shop"><h2 style="color:#FFD700;margin-top:40px;text-transform:uppercase;letter-spacing:2px;text-shadow:0 0 10px gold">Ultra Collection</h2><div class="grid" id="grid"></div><button class="btn ptr" style="width:150px;margin-top:20px" onclick="closeShop()">BACK</button></div>
<div id="unlock-screen"><div class="unlock-card"><div class="unlock-header">NEW UNLOCK!</div><img id="unlock-img" class="unlock-preview" src="" /><div id="unlock-name" class="unlock-name">Royal Crown</div><button class="unlock-btn ptr" onclick="closeUnlock()">EQUIP NOW</button></div></div>
<div id="ui"><div id="stats"><button class="badge ptr" onclick="goHome()">üè†</button><div><span class="badge">LV <span id="lv">1</span></span> <span class="badge">üí∞ <span id="cn">5000</span></span> <span class="badge">üíé <span id="dm">0</span></span></div></div><div id="msg" style="position:absolute;top:18%;width:100%;text-align:center;font-size:26px;font-weight:900;color:#FFD700;text-shadow:0 2px 10px #000">READY?</div><div class="bet-box" id="ctrls"><button class="btn b-ctrl ptr" onclick="btnAnim(this); setBet(-200)">-</button><button id="btnPlay" class="btn b-play ptr" onclick="btnAnim(this); play()">BET 200 üí∞</button><button class="btn b-ctrl ptr" onclick="btnAnim(this); setBet(200)">+</button></div></div>
<div id="win"><div class="win-top" id="wLine1">VICTORY!</div><div class="win-main" id="wLine2">YOU WON</div><div class="win-amt" id="wLine3">+1000 üí∞</div><div class="trophy-box"><div class="glow" id="tGlow"></div><div class="ring r1"></div><div class="ring r2"></div><div class="trophy" id="trp">üèÜ</div></div><button id="wBtn" class="btn ptr" onclick="btnAnim(this); resume()">CONTINUE</button></div>
<div id="lose"><div class="lose-box"><h2 class="lose-title">FAILED!</h2><button id="reviveBtn" class="btn lose-btn ptr" onclick="btnAnim(this); revive()">REVIVE ‚Ä¢ ???üí∞</button><button class="btn lose-btn ptr" style="background:#ffaa00;color:#000" onclick="btnAnim(this); resume()">RETRY</button></div></div>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script>
let isOnline = false;
async function checkInternetConnection(){const n=document.getElementById('no-internet');try{await fetch('https://www.google.com/favicon.ico?'+new Date().getTime(),{mode:'no-cors',cache:'no-store'});n.style.display='none';isOnline=true}catch(e){n.style.display='flex';isOnline=false}}checkInternetConnection();setInterval(checkInternetConnection,5000);
function triggerVib(t){if(!navigator.vibrate)return;const s=volConfig.vib/100;if(s<=0)return;const d=m=>Math.max(1,Math.floor(m*s));switch(t){case'ui':navigator.vibrate(d(15));break;case'lift':navigator.vibrate(d(40));break;case'bump':navigator.vibrate(d(20));break;case'heavy':navigator.vibrate([d(100),50,d(100)]);break;case'win':navigator.vibrate([d(50),50,d(50),50,d(100)]);break;case'lose':navigator.vibrate(d(300));break}}
const soundFiles={bg:'sound/background.mp3',ui:'sound/click_aur_tape.mp3',home:'sound/menu_click.mp3',shuffle:'sound/Shuffle_cups.mp3',win:'sound/winning.mp3',wrong:'sound/field.mp3',lift:'sound/pickup.mp3',purchase:'sound/purchase.mp3',collect:'sound/coincollect.mp3'},volConfig={ui:0.8,home:0.8,shuffle:0.8,win:0.65,wrong:0.8,lift:0.8,bg:0.5,vib:100,purchase:0.8,collect:0.8},snd={};let bgPlaying=!1;Object.keys(soundFiles).forEach(k=>{snd[k]=new Audio(soundFiles[k]);snd[k].preload="auto";snd[k].loop=(k==='bg'||k==='shuffle');});
function playSound(k){if(snd[k]){snd[k].volume=volConfig[k];const p=snd[k].play();if(p!==undefined)p.catch(e=>{});if(k!=='shuffle'&&k!=='bg')snd[k].currentTime=0}}
function startBgMusic(){if(!bgPlaying&&snd.bg){snd.bg.volume=volConfig.bg;snd.bg.play().then(()=>{bgPlaying=!0}).catch(e=>{})}}
function unlockAudio(){Object.keys(snd).forEach(k=>{if(k!=='bg'){snd[k].play().then(()=>{snd[k].pause();snd[k].currentTime=0}).catch(e=>{})}})}
document.body.addEventListener('touchstart',()=>{unlockAudio();startBgMusic()},{once:!0});document.body.addEventListener('click',()=>{unlockAudio();startBgMusic()},{once:!0});
window.openSettings=()=>{triggerVib('ui');playSound('ui');Object.keys(volConfig).forEach(k=>{const e=document.getElementById(`rng-${k}`),t=document.getElementById(`val-${k}`);if(e&&t){let v=k==='vib'?volConfig[k]:Math.floor(volConfig[k]*100);e.value=v;t.innerText=v}});document.getElementById('settings').style.display='flex'};window.closeSettings=()=>{triggerVib('ui');playSound('ui');document.getElementById('settings').style.display='none'};window.updVol=(k,v)=>{if(k==='vib'){volConfig[k]=parseInt(v)}else{volConfig[k]=v/100}document.getElementById(`val-${k}`).innerText=v;if(k==='bg'&&bgPlaying){snd.bg.volume=volConfig.bg}saveData()};window.tstVol=k=>{if(snd[k]){snd[k].volume=volConfig[k];snd[k].currentTime=0;snd[k].play().catch(e=>{});if(k==='shuffle'||k==='bg')setTimeout(()=>{if(k!=='bg'||!bgPlaying)snd[k].pause()},2000)}};
window.doReset=()=>{triggerVib('ui');playSound('ui');openCustomModal("RESET GAME?","This will delete all progress, coins, and skins!",true,()=>{localStorage.removeItem('royalCupsData_v7');location.reload()})};
window.doFreeCoins=()=>{triggerVib('ui');playSound('ui');if(coin<500){addCurrencySmoothly('coin', 2000);openCustomModal("SUCCESS!","2000 Emergency Coins Added!",false,null)}else{openCustomModal("FAILED","Balance must be less than 500!",false,null)}};
const skins=[];const skinDefinitions=[{n:"Golden Royal",t:"coin",v:5000,style:"royal"},{n:"Fire Skull",t:"diamond",v:50,style:"fireSkull"},{n:"Inferno Swirl",t:"diamond",v:100,style:"fireSwirl"},{n:"Plasma Star",t:"diamond",v:250,style:"plasmaStar"},{n:"Rainbow Cloud",t:"diamond",v:500,style:"rainbow"},{n:"Night Moon",t:"diamond",v:800,style:"moonNight"},{n:"Orange Blaze",t:"diamond",v:1200,style:"blazeOrange"},{n:"Red Stripes",t:"diamond",v:2000,style:"stripesRed"},{n:"Starry Blue",t:"diamond",v:3500,style:"starBlue"},{n:"Biohazard Green",t:"diamond",v:8000,style:"bioGreen"},{n:"Blue Lightning",t:"coin",v:9000,style:"lightningBlue"},{n:"POW Comic",t:"coin",v:15000,style:"pow"},{n:"Neon Wolf",t:"coin",v:25000,style:"wolf"},{n:"Magma Crack",t:"coin",v:40000,style:"magma"},{n:"Red Phoenix",t:"coin",v:60000,style:"phoenix"},{n:"Blue Monster",t:"coin",v:85000,style:"monsterBlue"},{n:"Purple Nebula",t:"coin",v:110000,style:"nebulaPurple"},{n:"Orange Furry",t:"coin",v:140000,style:"furryOrange"},{n:"Toxic Hazard",t:"coin",v:180000,style:"bioToxic"},{n:"Swirl Rainbow",t:"coin",v:220000,style:"swirlRain"},{n:"Red Dragon",t:"coin",v:270000,style:"dragonRed"},{n:"Green Vine",t:"coin",v:330000,style:"vineGreen"},{n:"Cloud Moon",t:"coin",v:400000,style:"cloudMoon"},{n:"Blue Flame",t:"coin",v:500000,style:"flameBlue"},{n:"Aurora Borealis",t:"coin",v:650000,style:"aurora"},{n:"Hypno Swirl",t:"coin",v:800000,style:"hypno"},{n:"Constellation",t:"coin",v:1000000,style:"constell"},{n:"Blue Smoke",t:"coin",v:1500000,style:"smokeBlue"},{n:"Electric Storm",t:"lv",v:5,style:"storm"},{n:"Lava Flow",t:"lv",v:10,style:"lava"},{n:"Galaxy Purple",t:"lv",v:15,style:"galaxy"},{n:"Red Star",t:"lv",v:20,style:"starRed"},{n:"Demon Skull",t:"lv",v:25,style:"skullDemon"},{n:"Spider Web",t:"lv",v:30,style:"web"},{n:"Blue Wisps",t:"lv",v:35,style:"wisp"},{n:"Alien Green",t:"lv",v:40,style:"alien"},{n:"Ghost Purple",t:"lv",v:45,style:"ghost"},{n:"Pumpkin Head",t:"lv",v:50,style:"pumpkin"},{n:"Blue Ghoul",t:"lv",v:55,style:"ghoul"},{n:"Green Plasma",t:"lv",v:60,style:"plasmaGreen"},{n:"Hell Fire",t:"lv",v:65,style:"hellFire"},{n:"Cosmic Purple",t:"lv",v:70,style:"cosmic"},{n:"Crystal Blue",t:"lv",v:75,style:"crystal"},{n:"Sun Power",t:"lv",v:80,style:"sun"},{n:"Toxic Skull",t:"lv",v:85,style:"skullToxic"},{n:"Pink Butterfly",t:"lv",v:90,style:"butterfly"},{n:"Magic Blue",t:"lv",v:100,style:"magic"}];
skinDefinitions.forEach((def,i)=>{skins.push({n:def.n,t:def.t,v:def.v,style:def.style,own:(i===0)})});const texCache={};

// ADDED: RC LOGO TEXTURE GENERATOR
function getRCLogoTex() {
    const c = document.createElement('canvas');
    c.width = 512; c.height = 512;
    const ctx = c.getContext('2d');
    ctx.fillStyle = 'radial-gradient(circle, #ffd700, #b8860b)';
    ctx.beginPath(); ctx.arc(256, 256, 256, 0, Math.PI * 2); ctx.fill();
    ctx.strokeStyle = '#fff'; ctx.lineWidth = 15; ctx.stroke();
    ctx.fillStyle = '#3d2616'; ctx.font = '900 240px Montserrat';
    ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
    ctx.shadowColor = 'rgba(0,0,0,0.5)'; ctx.shadowBlur = 10;
    ctx.fillText('RC', 256, 256);
    const t = new THREE.CanvasTexture(c);
    t.colorSpace = THREE.SRGBColorSpace;
    return t;
}

function genCupTex(id){if(texCache[id])return texCache[id];const styleName=skins[id]?skins[id].style:'royal';const c=document.createElement('canvas');c.width=2048;c.height=1024;const ctx=c.getContext('2d');const w=2048,h=1024,cx=w/2,cy=h/2;const fill=(fs)=>{ctx.fillStyle=fs;ctx.fillRect(0,0,w,h)};const addNoise=(amt)=>{const id=ctx.getImageData(0,0,w,h),d=id.data;for(let i=0;i<d.length;i+=4){const v=(Math.random()-0.5)*amt;d[i]+=v;d[i+1]+=v;d[i+2]+=v}ctx.putImageData(id,0,0)};const grad=(c1,c2,vertical=true)=>{let g=vertical?ctx.createLinearGradient(0,0,0,h):ctx.createLinearGradient(0,0,w,0);g.addColorStop(0,c1);g.addColorStop(1,c2);return g};const radGrad=(c1,c2)=>{let g=ctx.createRadialGradient(cx,cy,10,cx,cy,800);g.addColorStop(0,c1);g.addColorStop(1,c2);return g};const noise=(amount,color='rgba(255,255,255,0.1)')=>{ctx.fillStyle=color;for(let i=0;i<amount;i++)ctx.fillRect(Math.random()*w,Math.random()*h,3,3)};const lightning=(color,lw=6)=>{ctx.strokeStyle=color;ctx.lineWidth=lw;ctx.lineCap='round';for(let i=0;i<12;i++){ctx.beginPath();ctx.moveTo(Math.random()*w,0);let x=Math.random()*w,y=0;while(y<h){x+=(Math.random()-0.5)*150;y+=Math.random()*80;ctx.lineTo(x,y)}ctx.stroke()}};const drawSkull=(color,glow)=>{ctx.fillStyle=color;ctx.shadowColor=glow;ctx.shadowBlur=50;ctx.beginPath();ctx.arc(cx,cy-80,140,0,Math.PI*2);ctx.fill();ctx.fillRect(cx-90,cy,180,140);ctx.fillStyle='#000';ctx.shadowBlur=0;ctx.beginPath();ctx.arc(cx-50,cy-60,35,0,Math.PI*2);ctx.fill();ctx.beginPath();ctx.arc(cx+50,cy-60,35,0,Math.PI*2);ctx.fill();ctx.beginPath();ctx.moveTo(cx,cy+20);ctx.lineTo(cx-20,cy+70);ctx.lineTo(cx+20,cy+70);ctx.fill();ctx.fillStyle=color;for(let i=0;i<4;i++)ctx.fillRect(cx-60+i*35,cy+90,20,50)};const drawAlien=(color)=>{ctx.fillStyle=color;ctx.beginPath();ctx.ellipse(cx,cy,180,240,0,0,Math.PI*2);ctx.fill();ctx.fillStyle='#000';ctx.beginPath();ctx.ellipse(cx-70,cy,50,90,-0.4,0,Math.PI*2);ctx.fill();ctx.beginPath();ctx.ellipse(cx+70,cy,50,90,0.4,0,Math.PI*2);ctx.fill()};const stars=(count,color='#fff')=>{ctx.fillStyle=color;for(let i=0;i<count;i++){ctx.beginPath();ctx.arc(Math.random()*w,Math.random()*h,Math.random()*5,0,Math.PI*2);ctx.fill()}};const biohazard=(color,bg)=>{fill(bg);ctx.fillStyle=color;for(let i=0;i<3;i++){let ang=(i*2*Math.PI)/3;let x=cx+Math.cos(ang)*120;let y=cy+Math.sin(ang)*120;ctx.beginPath();ctx.arc(x,y,120,0,Math.PI*2);ctx.fill()}ctx.globalCompositeOperation='destination-out';ctx.beginPath();ctx.arc(cx,cy,100,0,Math.PI*2);ctx.fill();ctx.globalCompositeOperation='source-over';ctx.beginPath();ctx.arc(cx,cy,20,0,Math.PI*2);ctx.fillStyle=color;ctx.fill()};
switch(styleName){case'royal':fill(grad('#b8860b','#ffd700'));ctx.font='200px serif';ctx.textAlign='center';ctx.fillStyle='#5c4004';ctx.fillText('‚ôõ',cx,cy+60);addNoise(20);break;case'fireSkull':fill('#300');noise(1000,'#f00');drawSkull('#ffaa00','#ff0000');addNoise(30);break;case'lightningBlue':fill('#001');lightning('#0ff',8);addNoise(20);break;case'pow':fill('#00f');ctx.fillStyle='#ff0';ctx.beginPath();ctx.arc(cx,cy,240,0,Math.PI*2);ctx.fill();ctx.fillStyle='#f00';ctx.font='bold 200px Arial';ctx.textAlign='center';ctx.fillText("POW!",cx,cy+60);break;case'wolf':fill('#002');ctx.strokeStyle='#0af';ctx.lineWidth=20;ctx.beginPath();ctx.moveTo(cx-100,cy-100);ctx.lineTo(cx,cy+100);ctx.lineTo(cx+100,cy-100);ctx.stroke();ctx.fillStyle='#0ff';ctx.beginPath();ctx.arc(cx-60,cy-40,20,0,7);ctx.arc(cx+60,cy-40,20,0,7);ctx.fill();addNoise(15);break;case'magma':fill('#500');lightning('#fa0',12);noise(2000,'#f50');addNoise(40);break;case'plasmaStar':fill(radGrad('#f0f','#202'));stars(200,'#ff0');break;case'rainbow':fill(grad('#f00','#00f'));ctx.fillStyle='rgba(255,255,255,0.5)';ctx.beginPath();ctx.arc(cx,cy,200,0,Math.PI,true);ctx.fill();break;case'bioGreen':biohazard('#0f0','#111');addNoise(30);break;case'phoenix':fill('#400');ctx.fillStyle='#f80';ctx.beginPath();ctx.moveTo(cx,cy-200);ctx.lineTo(cx+160,cy);ctx.lineTo(cx,cy+200);ctx.lineTo(cx-160,cy);ctx.fill();break;case'monsterBlue':fill('#004');drawAlien('#0af');break;case'nebulaPurple':fill('#102');stars(400);ctx.fillStyle='rgba(100,0,255,0.2)';ctx.fillRect(0,0,w,h);break;case'furryOrange':fill('#d60');noise(4000,'#fa0');ctx.fillStyle='#000';ctx.beginPath();ctx.arc(cx-100,cy,60,0,7);ctx.arc(cx+100,cy,60,0,7);ctx.fill();break;case'bioToxic':biohazard('#ff0','#220');break;case'moonNight':fill('#002');stars(100);ctx.fillStyle='#ffc';ctx.beginPath();ctx.arc(cx,cy,120,0,7);fill();break;case'swirlRain':fill(grad('#f00','#0f0'));ctx.fillStyle='rgba(0,255,255,0.5)';ctx.beginPath();ctx.arc(cx,cy,200,0,7);ctx.fill();break;case'dragonRed':fill('#400');ctx.strokeStyle='#f00';ctx.lineWidth=10;ctx.beginPath();ctx.arc(cx,cy,200,0,7);ctx.stroke();addNoise(30);break;case'vineGreen':fill('#020');ctx.strokeStyle='#0f0';ctx.lineWidth=8;lightning('#0f0');break;case'cloudMoon':fill('#224');ctx.fillStyle='#aaa';ctx.beginPath();ctx.arc(cx,cy,160,0,7);ctx.fill();addNoise(20);break;case'fireSwirl':fill(radGrad('#ff0','#f00'));addNoise(20);break;case'flameBlue':fill('#000');ctx.fillStyle='#08f';ctx.beginPath();ctx.moveTo(cx,h);ctx.quadraticCurveTo(cx-200,cy,cx,cy-200);ctx.quadraticCurveTo(cx+200,cy,cx,h);ctx.fill();break;case'blazeOrange':fill(grad('#fa0','#a20'));noise(1000,'#fff');addNoise(25);break;case'starBlue':fill('#004');stars(200,'#0ff');break;case'stripesRed':fill('#f00');ctx.fillStyle='#ff0';for(let i=0;i<w;i+=100)ctx.fillRect(i,0,50,h);break;case'aurora':fill('#000');ctx.fillStyle='#0f8';ctx.filter='blur(40px)';ctx.beginPath();ctx.moveTo(0,cy);ctx.bezierCurveTo(600,cy-400,1400,cy+400,w,cy);ctx.lineTo(w,h);ctx.lineTo(0,h);ctx.fill();ctx.filter='none';break;case'hypno':fill('#000');ctx.strokeStyle='#f0f';ctx.lineWidth=20;for(let i=20;i<600;i+=40){ctx.beginPath();ctx.arc(cx,cy,i,0,7);ctx.stroke()}break;case'constell':fill('#012');ctx.strokeStyle='#fff';stars(100);ctx.beginPath();ctx.moveTo(400,400);ctx.lineTo(800,600);ctx.lineTo(1200,400);ctx.stroke();break;case'smokeBlue':fill('#001');ctx.fillStyle='rgba(0,100,255,0.3)';ctx.filter='blur(60px)';ctx.fillRect(200,200,1600,600);ctx.filter='none';break;case'storm':fill('#111');lightning('#fff',4);lightning('#00f',10);addNoise(20);break;case'lava':fill('#300');ctx.fillStyle='#f50';ctx.beginPath();ctx.moveTo(0,h);ctx.quadraticCurveTo(cx,cy,w,h);ctx.fill();addNoise(40);break;case'galaxy':fill(radGrad('#f0f','#000'));stars(600);break;case'starRed':fill('#200');stars(200,'#f55');break;case'skullDemon':fill('#200');drawSkull('#ccc','#f00');addNoise(30);break;case'web':fill('#000');ctx.strokeStyle='#f40';ctx.lineWidth=4;for(let i=0;i<12;i++){ctx.beginPath();ctx.moveTo(cx,cy);ctx.lineTo(cx+Math.cos(i)*800,cy+Math.sin(i)*800);ctx.stroke()}break;case'wisp':fill('#002');ctx.fillStyle='rgba(0,255,255,0.2)';ctx.filter='blur(30px)';ctx.beginPath();ctx.arc(cx,cy,200,0,7);ctx.fill();ctx.filter='none';break;case'alien':fill('#020');drawAlien('#0f0');break;case'ghost':fill('#103');ctx.fillStyle='#fff';ctx.shadowBlur=40;ctx.shadowColor='#fff';ctx.beginPath();ctx.arc(cx,cy-40,120,0,Math.PI,true);ctx.lineTo(cx-120,cy+160);ctx.lineTo(cx+120,cy+160);ctx.fill();break;case'pumpkin':fill('#420');ctx.fillStyle='#f70';ctx.beginPath();ctx.arc(cx,cy,200,0,7);ctx.fill();ctx.fillStyle='#000';ctx.beginPath();ctx.moveTo(cx-80,cy-40);ctx.lineTo(cx-40,cy-100);ctx.lineTo(cx,cy-40);ctx.fill();fill();ctx.beginPath();ctx.moveTo(cx+80,cy-40);ctx.lineTo(cx+40,cy-100);ctx.lineTo(cx,cy-40);ctx.fill();break;case'ghoul':fill('#002');drawSkull('#0ff','#00f');break;case'plasmaGreen':fill('#010');ctx.fillStyle='#0f0';ctx.filter='blur(20px)';ctx.fillRect(cx-200,cy-200,400,400);ctx.filter='none';break;case'hellFire':fill('#200');lightning('#f00');addNoise(30);break;case'cosmic':fill('#102');stars(300,'#f0f');break;case'crystal':fill('#004');ctx.strokeStyle='#0ff';for(let i=0;i<40;i++)ctx.strokeRect(Math.random()*w,Math.random()*h,100,100);break;case'sun':fill(radGrad('#fff','#fa0'));addNoise(10);break;case'skullToxic':fill('#110');drawSkull('#bf0','#0f0');addNoise(20);break;case'butterfly':fill('#202');ctx.fillStyle='#f0f';ctx.beginPath();ctx.arc(cx-100,cy,120,0,7);ctx.arc(cx+100,cy,120,0,7);ctx.fill();break;case'magic':fill('#003');lightning('#00f');stars(200,'#fff');break;default:fill('#444');break}
let vig=ctx.createLinearGradient(0,0,w,0);vig.addColorStop(0,'rgba(0,0,0,0.6)');vig.addColorStop(.2,'rgba(0,0,0,0.1)');vig.addColorStop(.8,'rgba(0,0,0,0.1)');vig.addColorStop(1,'rgba(0,0,0,0.6)');ctx.fillStyle=vig;ctx.fillRect(0,0,w,h);const t=new THREE.CanvasTexture(c);t.colorSpace=THREE.SRGBColorSpace;if(ren)t.anisotropy=ren.capabilities.getMaxAnisotropy();const p=ctx.getImageData(cx,cy,1,1).data;t.userData={color:new THREE.Color(`rgb(${p[0]},${p[1]},${p[2]})`)};texCache[id]=t;return t}
function createWoodTexture(){const c=document.createElement('canvas');c.width=1024;c.height=1024;const ctx=c.getContext('2d');ctx.fillStyle='#3d2310';ctx.fillRect(0,0,1024,1024);for(let i=0;i<40000;i++){ctx.fillStyle=Math.random()>0.5?'rgba(0,0,0,0.08)':'rgba(255,255,255,0.04)';ctx.fillRect(Math.random()*1024,Math.random()*1024,2,Math.random()*40+10)}ctx.lineWidth=2;ctx.strokeStyle='rgba(0,0,0,0.15)';for(let i=0;i<30;i++){ctx.beginPath();ctx.moveTo(0,Math.random()*1024);ctx.bezierCurveTo(300,Math.random()*1024,700,Math.random()*1024,1024,Math.random()*1024);ctx.stroke()}const t=new THREE.CanvasTexture(c);t.wrapS=THREE.RepeatWrapping;t.wrapT=THREE.RepeatWrapping;t.colorSpace=THREE.SRGBColorSpace;return t}
let sc,cam,ren,ball,cups=[],locked=!0,coin=5000,diamonds=0,lev=1,winCup=null,bet=200,lastWin=-1,skinIdx=0,currentReviveCost=0,trophyAnim=null,unlockedSkinId=-1,dailyData={day:1,last:''},mData={last:'',p:0,w:0,b:0,c:[0,0,0,0,0]},playerName="GUEST PLAYER",avatarId=0,timerInterval;
const avatars=[{id:0,c:"linear-gradient(135deg,#444,#111)",img:"https://raw.githubusercontent.com/tbshan894-sketch/Profile/main/dp1.png",p:0},{id:1,c:"linear-gradient(135deg,#ffd700,#b8860b)",img:"https://raw.githubusercontent.com/tbshan894-sketch/Profile/main/dp2.png",p:0},{id:2,c:"linear-gradient(135deg,#00f260,#0575e6)",img:"https://raw.githubusercontent.com/tbshan894-sketch/Profile/main/dp3.png",p:100},{id:3,c:"linear-gradient(135deg,#ff00cc,#333399)",img:"https://raw.githubusercontent.com/tbshan894-sketch/Profile/main/dp4.png",p:150},{id:4,c:"linear-gradient(135deg,#ff416c,#ff4b2b)",img:"https://raw.githubusercontent.com/tbshan894-sketch/Profile/main/dp5.png",p:200},{id:5,c:"linear-gradient(135deg,#a8ff78,#78ffd6)",img:"https://raw.githubusercontent.com/tbshan894-sketch/Profile/main/dp6.png",p:250},{id:6,c:"linear-gradient(135deg,#833ab4,#fd1d1d)",img:"https://raw.githubusercontent.com/tbshan894-sketch/Profile/main/dp7.png",p:300},{id:7,c:"linear-gradient(135deg,#f7971e,#ffd200)",img:"https://raw.githubusercontent.com/tbshan894-sketch/Profile/main/dp8.png",p:350}];
let ownedAvatars=[0,1];
function init(){loadData();sc=new THREE.Scene();
const loader = new THREE.TextureLoader();
loader.load('https://raw.githubusercontent.com/tbshan894-sketch/Background-/main/background.png', function(texture) {
    texture.colorSpace = THREE.SRGBColorSpace;
    sc.background = texture;
});
sc.environment=new THREE.Color(0x222222);ren=new THREE.WebGLRenderer({antialias:!0,powerPreference:"high-performance",stencil:false,depth:true});ren.setSize(window.innerWidth,window.innerHeight);ren.setPixelRatio(window.devicePixelRatio);ren.shadowMap.enabled=!0;ren.shadowMap.type=THREE.PCFSoftShadowMap;ren.outputColorSpace=THREE.SRGBColorSpace;ren.toneMapping=THREE.ACESFilmicToneMapping;ren.toneMappingExposure=1.0;document.body.appendChild(ren.domElement);cam=new THREE.PerspectiveCamera(35,window.innerWidth/window.innerHeight,.1,100);setCam();sc.add(new THREE.AmbientLight(0xffffff,0.7));const sl=new THREE.SpotLight(0xffeeb1,3.5);sl.position.set(0,25,5);sl.angle=0.8;sl.penumbra=0.5;sl.castShadow=!0;sl.shadow.mapSize.width=2048;sl.shadow.mapSize.height=2048;sl.shadow.bias=-0.0001;sc.add(sl);const rim=new THREE.PointLight(0x4455ff,1,30);rim.position.set(-5,5,-5);sc.add(rim);const fillL=new THREE.PointLight(0xffaa00,0.8,20);fillL.position.set(-5,8,5);sc.add(fillL);mkTable();mkBall();mkCups();updUI();initCasinoEffects();setTimeout(()=>{mkShop()},100);checkMissionReset();startTimer();window.onresize=()=>{cam.aspect=window.innerWidth/window.innerHeight;cam.updateProjectionMatrix();ren.setSize(window.innerWidth,window.innerHeight);setCam()};ren.domElement.onpointerdown=tap;animate();document.addEventListener('mousemove',createTrail);document.addEventListener('touchmove',createTrail)}
function initCasinoEffects(){const c=document.getElementById('casino-effects');if(!c)return;const symbols=['‚ô†Ô∏è','‚ô•Ô∏è','‚ô¶Ô∏è','‚ô£Ô∏è','ü™ô'];for(let i=0;i<20;i++){const d=document.createElement('div');d.className='fall-item';d.innerText=symbols[Math.floor(Math.random()*symbols.length)];d.style.left=Math.random()*100+'%';d.style.animationDuration=(Math.random()*5+5)+'s';d.style.animationDelay=(Math.random()*5)+'s';c.appendChild(d)}}
function mkTable(){const g=new THREE.Group();const woodMap=createWoodTexture();const f=new THREE.Mesh(new THREE.CylinderGeometry(10,10,.5,64),new THREE.MeshStandardMaterial({color:0x056622,roughness:.8,metalness:0.1}));f.receiveShadow=!0;f.position.y=-0.25;g.add(f);const woodMat=new THREE.MeshStandardMaterial({map:woodMap,color:0x885533,roughness:0.6,metalness:0.1,bumpMap:woodMap,bumpScale:0.05});const r=new THREE.Mesh(new THREE.CylinderGeometry(10.8,11,.45,64),woodMat);r.receiveShadow=!0;r.position.y=-0.35;g.add(r);const l=new THREE.Mesh(new THREE.CylinderGeometry(3,4,10,32),woodMat);l.position.y=-5.35;l.receiveShadow=!0;g.add(l);const b=new THREE.Mesh(new THREE.CylinderGeometry(6,6,1,32),woodMat);b.position.y=-10;b.receiveShadow=!0;g.add(b);const gd=new THREE.Mesh(new THREE.PlaneGeometry(500,500),new THREE.MeshStandardMaterial({color:0x050505,roughness:0.9,transparent:true,opacity:0.5}));gd.rotation.x=-Math.PI/2;gd.position.y=-10.5;gd.receiveShadow=!0;sc.add(gd);sc.add(g)}
function mkBall(){ball=new THREE.Mesh(new THREE.SphereGeometry(.35,64,64),new THREE.MeshPhysicalMaterial({color:0xffffff,metalness:.4,roughness:.1,clearcoat:1,clearcoatRoughness:0}));ball.castShadow=!0;sc.add(ball)}
function getCupCount(){return lev<=5?3:(lev<=10?4:5)}

// RE-WRITTEN MKCUPS FOR 3D RC LOGO & HIGH REALISM
function mkCups(){cups.forEach(c=>sc.remove(c));cups=[];const ct=getCupCount();let sp=(ct===4)?2.8:(ct===5?2.6:3.5);
const rcTex = getRCLogoTex();
for(let i=0;i<ct;i++){const g=new THREE.Group(),geo=new THREE.CylinderGeometry(.85,1.2,2.4,64);const mS=new THREE.MeshPhysicalMaterial({color:0xffffff,metalness:0.4,roughness:0.1,clearcoat:1,clearcoatRoughness:0.05});const mT=new THREE.MeshStandardMaterial({color:0xffffff,roughness:0.1});const mB=new THREE.MeshStandardMaterial({color:0x000000});const b=new THREE.Mesh(geo,[mS,mT,mB]);b.position.y=1.2;b.rotation.y=Math.PI;b.castShadow=!0;b.receiveShadow=!0;g.add(b);
// 3D RC LOGO DISC
const rcLogo=new THREE.Mesh(new THREE.CylinderGeometry(0.5,0.5,0.08,32),new THREE.MeshPhysicalMaterial({map:rcTex,metalness:0.9,roughness:0.1,clearcoat:1}));rcLogo.position.y=2.45;g.add(rcLogo);g.userData.logo=rcLogo;
const r=new THREE.Mesh(new THREE.TorusGeometry(1.2,0.06,16,64),new THREE.MeshStandardMaterial({color:0xffffff,metalness:0.8,roughness:0.2}));r.rotation.x=Math.PI/2;r.position.y=0.06;g.add(r);g.position.set((i-(ct-1)/2)*sp,0,0);cups.push(g);sc.add(g)}applySkin(skinIdx)}

function applySkin(id){skinIdx=id;const t=genCupTex(id),bc=t.userData.color||new THREE.Color(0xffffff);cups.forEach(g=>{const m=g.children[0];m.material[0].map=t;m.material[0].color=new THREE.Color(0xffffff);m.material[0].needsUpdate=!0;m.material[1].map=null;m.material[1].color=bc;m.material[1].needsUpdate=!0;g.children[2].material.color=bc})}
function mkShop(){const d=document.getElementById('grid');d.innerHTML='';let idxs=skins.map((_,i)=>i);idxs.sort((a,b)=>{if(skins[a].own&&!skins[b].own)return-1;if(!skins[a].own&&skins[b].own)return 1;return a-b});idxs.forEach(i=>{const s=skins[i];const el=document.createElement('div');el.id=`skin-item-${i}`;el.className='item ptr';let bgUrl='';try{const pc=document.createElement('canvas');pc.width=128;pc.height=128;const ctx=pc.getContext('2d');const t=genCupTex(i);if(t.image)ctx.drawImage(t.image,1024-256,512-256,512,512,0,0,128,128);bgUrl=pc.toDataURL()}catch(e){bgUrl=''}el.innerHTML=`<div class="prev" style="background-image:url(${bgUrl});"></div><div style="color:#fff;font-weight:bold;font-size:10px">${s.n}</div><div class="tag" id="tag-${i}"></div><div id="btn-area-${i}"></div>`;el.onclick=()=>{triggerVib('ui');playSound('ui');if(s.own){applySkin(i);saveData();updateShopUI()}else if(s.t==='lv'){openCustomModal("LOCKED",`Reach Level ${s.v} to unlock!`,false,null)}else if(s.t==='coin'){buySkin(i)}else if(s.t==='diamond'){buySkinDiamond(i)}};d.appendChild(el)});updateShopUI()}
function updateShopUI(){skins.forEach((s,i)=>{const el=document.getElementById(`skin-item-${i}`);if(!el)return;const t=el.querySelector(`#tag-${i}`),ba=el.querySelector(`#btn-area-${i}`),lck=!s.own;el.className='item ptr '+(lck?'lck':'')+(i===skinIdx?' act':'');let st="OWNED";if(lck){if(s.t==='lv')st=`LVL ${s.v}`;else if(s.t==='diamond')st=`${s.v} üíé`;else st=`${s.v/1000}K üí∞`}if(i===skinIdx)st="EQUIPPED";t.innerText=st;t.style.color=lck?'#ff4444':'#00ff00';if(lck&&(s.t==='coin'||s.t==='diamond')){ba.innerHTML=`<button class="buy-btn ptr" onclick="event.stopPropagation();${s.t==='coin'?'buySkin('+i+')':'buySkinDiamond('+i+')'}">BUY</button>`}else{ba.innerHTML=''}});const bf=document.getElementById('btnFree');if(bf){if(coin<500)bf.classList.add('active');else bf.classList.remove('active')}}
window.buySkin=(id)=>{triggerVib('ui');const s=skins[id];if(coin>=s.v){openCustomModal("BUY SKIN?",`Buy ${s.n} for ${s.v} Coins?`,true,()=>{playSound('purchase');coin-=s.v;s.own=!0;applySkin(id);saveData();updUI();updateShopUI()})}else{openCustomModal("FAILED","Not enough coins!",false,null)}};window.buySkinDiamond=(id)=>{triggerVib('ui');const s=skins[id];if(diamonds>=s.v){openCustomModal("BUY SKIN?",`Buy ${s.n} for ${s.v} Diamonds?`,true,()=>{playSound('purchase');diamonds-=s.v;s.own=!0;applySkin(id);saveData();updUI();updateShopUI()})}else{openCustomModal("FAILED","Not enough Diamonds!",false,null)}};
function checkUnlocks(){let un=!1;skins.forEach((s,i)=>{if(!s.own&&s.t==='lv'&&lev>=s.v){s.own=!0;unlockedSkinId=i;un=!0;showUnlockPopup(i)}});if(un)updateShopUI()}
function showUnlockPopup(id){const s=skins[id];document.getElementById('unlock-name').innerText=s.n.replace(/LVL \d+ /,'');const c=document.createElement('canvas');c.width=256;c.height=256;const ctx=c.getContext('2d'),t=genCupTex(id);if(t.image)ctx.drawImage(t.image,1024-256,512-256,512,512,0,0,256,256);document.getElementById('unlock-img').src=c.toDataURL();document.getElementById('unlock-screen').style.display='flex'}
window.closeUnlock=()=>{triggerVib('ui');playSound('ui');document.getElementById('unlock-screen').style.display='none';if(unlockedSkinId!==-1){applySkin(unlockedSkinId);saveData();updateShopUI()}};window.openPopup=id=>{const el=document.getElementById(id);el.style.opacity=0;el.style.display='flex';gsap.to(el,{opacity:1,duration:0.3})};window.openDaily=()=>{triggerVib('ui');playSound('ui');renderDailyGrid();const s=document.getElementById('daily-screen');s.style.display='flex';gsap.fromTo(s,{opacity:0},{opacity:1,duration:0.3})};
let exCoinInput=7000,exDiamondInput=30;
window.openExchange=()=>{triggerVib('ui');playSound('ui');document.getElementById('menu-coin').style.display='none';const s=document.getElementById('exchange-screen');s.style.display='flex';document.getElementById('ex-h-c').innerText=coin;document.getElementById('ex-h-d').innerText=diamonds;gsap.fromTo(s,{opacity:0},{opacity:1,duration:0.3})};
window.closeExchange=()=>{triggerVib('ui');playSound('ui');document.getElementById('menu-coin').style.display='flex';const s=document.getElementById('exchange-screen');gsap.to(s,{opacity:0,duration:0.2,onComplete:()=>s.style.display='none'})};
window.adjustExVal=(type,amt)=>{triggerVib('ui');if(type==='L'){exCoinInput+=amt;if(exCoinInput<1000)exCoinInput=1000;document.getElementById('ex-val-L').innerText=exCoinInput;document.getElementById('ex-feed-L').innerText="GET: üíé "+Math.floor(exCoinInput/1000)}else{exDiamondInput+=amt;if(exDiamondInput<1)exDiamondInput=1;document.getElementById('ex-val-R').innerText=exDiamondInput;document.getElementById('ex-feed-R').innerText="GET: üí∞ "+(exDiamondInput*1000)}};
window.executeExchange=(type)=>{triggerVib('ui');if(type==='L'){let cost=exCoinInput,gain=Math.floor(cost/1000);if(gain<1){openCustomModal("ERROR","Min 1000 Coins required!",false,null);return}if(coin>=cost){openCustomModal("EXCHANGE?",`Spend ${cost} Coins for ${gain} Diamonds?`,true,()=>{coin-=cost;addCurrencySmoothly('diamond', gain);playSound('purchase');document.getElementById('ex-h-c').innerText=coin;document.getElementById('ex-h-d').innerText=diamonds;openCustomModal("SUCCESS",`+${gain} Diamonds`,false,null)})}else{openCustomModal("FAILED","Not enough coins!",false,null)}}else{let cost=exDiamondInput,gain=cost*1000;if(diamonds>=cost){openCustomModal("EXCHANGE?",`Spend ${cost} Diamonds for ${gain} Coins?`,true,()=>{diamonds-=cost;addCurrencySmoothly('coin', gain);playSound('purchase');document.getElementById('ex-h-c').innerText=coin;document.getElementById('ex-h-d').innerText=diamonds;openCustomModal("SUCCESS",`+${gain} Coins`,false,null)})}else{openCustomModal("FAILED","Not enough diamonds!",false,null)}}};
const dailyRewardsList=[{d:10,c:1000},{d:15,c:1500},{d:20,c:2000},{d:25,c:2500},{d:30,c:3000},{d:40,c:4000},{skin:true}];
function renderDailyGrid(){const m=document.getElementById('daily-grid-main');m.innerHTML='';const t=new Date().toDateString(),cc=(dailyData.last!==t);for(let i=1;i<=6;i++){const rw=dailyRewardsList[i-1];let rwText='';if(rw.d>0)rwText+=`${rw.d}üíé `;if(rw.c>0)rwText+=`${rw.c}üí∞`;const el=document.createElement('div');el.className='day-card';el.id=`day-card-${i}`;let ic=`<div class="d-lock">üîí</div>`,rc="#888",tc="#888";if(i<dailyData.day){el.classList.add('claimed');ic=`<div class="d-icon">‚úÖ</div>`}else if(i===dailyData.day){if(cc){el.classList.add('active');ic=`<div class="d-icon" style="font-size:20px">üíéüí∞</div>`;rc="#FFD700";tc="#fff"}else{el.classList.add('claimed');el.style.borderColor='orange';ic=`<div class="d-icon">‚è≥</div>`;ic+=`<div class="box-timer" id="timer-box-${i}">--:--:--</div>`}}else{ic=`<div class="d-lock">üîí</div>`}el.innerHTML=`<div class="d-title" style="color:${tc}">DAY ${i}</div>${ic}<div class="d-rew" style="color:${rc}">${rwText}</div>`;m.appendChild(el)}startTimer()}
function startTimer(){const b=document.getElementById('claimDailyBtn');if(!b)return;const t=new Date().toDateString();if(dailyData.last!==t){if(timerInterval)clearInterval(timerInterval);b.disabled=!1;b.innerHTML=(dailyData.day===7)?"CLAIM MYSTERY SKIN":"CLAIM REWARD";b.style.background=(dailyData.day===7)?"linear-gradient(90deg, #9900ff, #ff00ff)":"linear-gradient(90deg, #eebb55, #cc8800, #eebb55)";b.style.opacity=1}else{b.disabled=!0;b.style.opacity=0.5;b.style.background="#221105";if(timerInterval)clearInterval(timerInterval);const update=()=>{const now=new Date(),tomorrow=new Date(now);tomorrow.setDate(tomorrow.getDate()+1);tomorrow.setHours(0,0,0,0);const diff=tomorrow-now,h=Math.floor((diff%(1000*60*60*24))/(1000*60*60)),m=Math.floor((diff%(1000*60))/(1000*60)),s=Math.floor((diff%(1000*60))/1000),timeStr=`${h}h ${m}m ${s}s`;b.innerHTML=`NEXT: ${timeStr}`;const boxTimer=document.getElementById(`timer-box-${dailyData.day}`);if(boxTimer)boxTimer.innerText=timeStr};update();timerInterval=setInterval(update,1000)}}
function addCurrencySmoothly(type, amount) {let startVal = (type === 'coin') ? coin : diamonds;let endVal = startVal + amount;let obj = { val: startVal };gsap.to(obj, {val: endVal,duration: 1.5,ease: "power2.out",onUpdate: () => {let current = Math.floor(obj.val);if(type === 'coin') {coin = current;document.getElementById('menu-coin-val').innerText = current;document.getElementById('cn').innerText = current;} else {diamonds = current;document.getElementById('menu-diamond-val').innerText = current;document.getElementById('dm').innerText = current;}},onComplete: () => {if(type === 'coin') coin = endVal; else diamonds = endVal;saveData();updUI();}});}
function animateFlyer(startElem, type, callback) {const rect = startElem.getBoundingClientRect();const targetId = (type === 'coin') ? 'menu-coin-val' : 'menu-diamond-val';const targetEl = document.getElementById(targetId);if (!targetEl) { if (callback) callback(); return; }const tRect = targetEl.getBoundingClientRect();const count = 8;let completed = 0;playSound('collect');createBurst(rect.left + rect.width / 2, rect.top + rect.height / 2);for (let i = 0; i < count; i++) {const c = document.createElement('div');c.className = (type === 'coin') ? 'fly-coin' : 'fly-diamond';c.innerText = (type === 'coin') ? 'üí∞' : 'üíé';const startX = rect.left + rect.width / 2;const startY = rect.top + rect.height / 2;c.style.transform = `translate3d(${startX}px, ${startY}px, 0) scale(0)`;document.body.appendChild(c);let delay = i * 0.05;let offsetX = (Math.random() - 0.5) * 100;let offsetY = (Math.random() - 0.5) * 100;const tl = gsap.timeline({delay: delay,onComplete: () => {c.remove();completed++;if (completed === count && callback) callback();}});tl.to(c, { x: startX + offsetX, y: startY + offsetY, scale: 1, duration: 0.3, ease: "back.out(1.7)" }).to(c, { x: tRect.left + tRect.width / 2, y: tRect.top + tRect.height / 2, scale: 0.5, opacity: 0.5, duration: 0.8, ease: "power2.in" });}}
function createBurst(x,y){const colors=['#FFD700','#00ccff','#FFFFFF'];for(let i=0;i<15;i++){const p=document.createElement('div');p.className='confetti';p.style.backgroundColor=colors[Math.floor(Math.random()*colors.length)];p.style.left='0px';p.style.top='0px';p.style.transform=`translate3d(${x}px,${y}px,0)`;document.body.appendChild(p);const angle=Math.random()*Math.PI*2,velocity=50+Math.random()*100,tx=x+Math.cos(angle)*velocity,ty=y+Math.sin(angle)*velocity;gsap.to(p,{x:tx,y:ty,opacity:0,scale:0.5,duration:0.6+Math.random()*0.4,ease:"power2.out",onComplete:()=>p.remove()})}}
window.claimDaily=()=>{const t=new Date().toDateString();if(dailyData.last===t)return;const b=document.getElementById('claimDailyBtn');triggerVib('heavy');gsap.to(b,{scale:0.9,duration:0.1,yoyo:!0,repeat:1});b.disabled=!0;b.innerHTML="CLAIMING...";const currentReward=dailyRewardsList[dailyData.day-1];if(dailyData.day===7){createBurst(window.innerWidth/2,window.innerHeight/2);let us=[];skins.forEach((s,i)=>{if(!s.own&&s.t!=='lv')us.push(i)});if(us.length>0){let r=Math.floor(Math.random()*us.length),id=us[r];skins[id].own=!0;unlockedSkinId=id;showUnlockPopup(id)}else{addCurrencySmoothly('coin', 5000);addCurrencySmoothly('diamond', 50)}dailyData.day=1;dailyData.last=t;saveData();renderDailyGrid();startTimer();b.innerHTML="SUCCESS! üéâ"}else{let hasCoin=currentReward.c>0,hasDiamond=currentReward.d>0;const finishClaim=()=>{dailyData.day++;dailyData.last=t;saveData();renderDailyGrid();startTimer();b.innerHTML="SUCCESS! üéâ"};if(hasCoin){animateFlyer(b,'coin',()=>{addCurrencySmoothly('coin',currentReward.c);if(!hasDiamond)finishClaim()})}if(hasDiamond){setTimeout(()=>{animateFlyer(b,'diamond',()=>{addCurrencySmoothly('diamond',currentReward.d);finishClaim()})},hasCoin?300:0)}}};
window.closeDaily=()=>{triggerVib('ui');playSound('ui');const s=document.getElementById('daily-screen');gsap.to(s,{opacity:0,duration:0.2,onComplete:()=>s.style.display='none'})};
function checkMissionReset(){const t=new Date().toDateString();if(mData.c.length<5)mData.c=[0,0,0,0,0];if(mData.last!==t){mData={last:t,p:0,w:0,b:0,c:[0,0,0,0,0]};saveData()}}function getDaySeed(){const d=new Date();return(d.getDate()+d.getMonth())%3}function getSkinPreview(id){const t=genCupTex(id);return t.image.toDataURL()}window.openMission=()=>{triggerVib('ui');playSound('ui');checkMissionReset();const s=document.getElementById('mission-screen');s.style.display='flex';renderMissions();gsap.fromTo(s,{opacity:0},{opacity:1,duration:0.3})};
function renderMissions(){const l=document.getElementById('mission-list');l.innerHTML='';const seed=getDaySeed();let ts=[];if(seed===0){ts=[{t:"WARM UP",d:"Play 20 Games",req:20,type:'p',r:"10 üíé"},{t:"LUCKY DAY",d:"Win 5 Games",req:5,type:'w',r:"15 üíé"},{t:"HIGH ROLLER",d:"Bet 2,000+ Coins",req:2000,type:'b',r:"3000 üí∞"},{t:"GRINDER",d:"Play 50 Games",req:50,type:'p',r:"20 üíé"},{t:"CHAMPION",d:"Win 20 Games",req:20,type:'w',r:"MAGMA SKIN",skin:5}]}else if(seed===1){ts=[{t:"PLAYER",d:"Play 40 Games",req:40,type:'p',r:"1500 üí∞"},{t:"STREAK",d:"Win 10 Games",req:10,type:'w',r:"20 üíé"},{t:"BIG BET",d:"Bet 5,000+ Coins",req:5000,type:'b',r:"50 üíé"},{t:"MASTER",d:"Play 80 Games",req:80,type:'p',r:"FIRE SKULL",skin:1},{t:"LEGEND",d:"Win 30 Games",req:30,type:'w',r:"BLUE LIGHTNING",skin:2}]}else{ts=[{t:"BEGINNER",d:"Play 30 Games",req:30,type:'p',r:"10 üíé"},{t:"WINNER",d:"Win 8 Games",req:8,type:'w',r:"2500 üí∞"},{t:"WHALE",d:"Bet 10,000+ Coins",req:10000,type:'b',r:"100 üíé"},{t:"ADDICT",d:"Play 100 Games",req:100,type:'p',r:"POW COMIC",skin:3},{t:"GODLIKE",d:"Win 40 Games",req:40,type:'w',r:"BIOHAZARD",skin:8}]}ts.forEach((t,i)=>{const r=document.createElement('div');r.className='mission-row';let c=0;if(t.type==='p')c=mData.p;if(t.type==='w')c=mData.w;if(t.type==='b')c=(mData.b>=t.req?t.req:0);let p=(c/t.req)*100;if(p>100)p=100;let bh="";if(mData.c[i]===1){bh=`<button class="m-btn done">CLAIMED</button>`}else if(c>=t.req){bh=`<button class="m-btn ready" id="mbtn-${i}" onclick="claimMission(${i},this,'${t.r}')">CLAIM</button>`}else{bh=`<button class="m-btn">${c}/${t.req}</button>`}let rh=t.skin?`<div class="m-rew-box"><div style="width:20px;height:20px;border-radius:50%;background:url(${getSkinPreview(t.skin)});background-size:cover;border:1px solid #aaa"></div> ${t.r}</div>`:`<div class="m-rew-box">üéÅ ${t.r}</div>`;r.innerHTML=`<div class="m-info"><div class="m-name">${t.t}</div><div class="m-prog">${t.d}</div><div class="m-bar-bg"><div class="m-bar-fill" style="width:${p}%"></div></div>${rh}</div>${bh}`;l.appendChild(r)})};
window.claimMission=(id,btn,rewardStr)=>{triggerVib('heavy');gsap.to(btn,{scale:0.9,duration:0.1,yoyo:!0,repeat:1});const seed=getDaySeed();let coinAdd=0,diamondAdd=0,skinId=-1;if(rewardStr.includes('üíé'))diamondAdd=parseInt(rewardStr.replace(/[^0-9]/g,''));if(rewardStr.includes('üí∞'))coinAdd=parseInt(rewardStr.replace(/[^0-9]/g,''));if(seed===0){if(id===4)skinId=5}if(seed===1){if(id===3)skinId=1;if(id===4)skinId=2}if(seed===2){if(id===3)skinId=3;if(id===4)skinId=8}const done=()=>{mData.c[id]=1;if(coinAdd>0)addCurrencySmoothly('coin', coinAdd);if(diamondAdd>0)addCurrencySmoothly('diamond', diamondAdd);if(skinId>-1){skins[skinId].own=!0;applySkin(skinId);openCustomModal("UNLOCKED!","Mission Skin Activated!",false,null)}btn.innerHTML="CLAIMED";btn.className="m-btn done";saveData();checkNotif();};if(coinAdd>0){animateFlyer(btn,'coin',done)}else if(diamondAdd>0){animateFlyer(btn,'diamond',done)}else{done()}};window.closeMission=()=>{triggerVib('ui');playSound('ui');const s=document.getElementById('mission-screen');gsap.to(s,{opacity:0,duration:0.2,onComplete:()=>s.style.display='none'})};function checkNotif(){const d=document.getElementById('msnDot');d.style.display='none'}
window.startGame=()=>{triggerVib('ui');playSound('ui');startBgMusic();locked=!0;const m=document.getElementById('menu'),u=document.getElementById('ui');document.getElementById('menu-coin').style.display='none';u.style.display='block';gsap.to(m,{opacity:0,duration:0.4,onComplete:()=>m.style.display='none'});gsap.to(u,{opacity:1,duration:0.4})};window.openShop=()=>{triggerVib('ui');playSound('ui');document.getElementById('shop').style.display='flex'};window.closeShop=()=>{triggerVib('ui');playSound('ui');if(snd.purchase&&!snd.purchase.paused){snd.purchase.pause();snd.purchase.currentTime=0}document.getElementById('shop').style.display='none'};window.setBet=n=>{if(!locked)return;let nb=bet+n;if(nb>=200&&nb<=coin){triggerVib('ui');bet=nb;document.getElementById('btnPlay').innerText=`BET ${bet} üí∞`;playSound('ui')}};window.goHome=()=>{triggerVib('ui');playSound('home');document.getElementById('menu-coin').style.display='flex';if(snd.shuffle){snd.shuffle.pause();snd.shuffle.currentTime=0}cups.forEach(c=>gsap.killTweensOf(c.position));document.getElementById('win').style.display='none';document.getElementById('lose').style.display='none';document.getElementById('ui').style.display='none';document.getElementById('menu').style.display='flex';gsap.to(document.getElementById('menu'),{opacity:1,duration:0.4});locked=!0;document.getElementById('ctrls').style.display='flex';document.getElementById('msg').innerText="READY?";mkCups();cups.forEach(c=>{c.position.y=0;c.position.z=0});if(coin<200)bet=0;else if(coin<bet)bet=200;if(bet<200&&coin>=200)bet=200;document.getElementById('btnPlay').innerText=`BET ${bet} üí∞`;updUI()};
window.openProfile=()=>{triggerVib('ui');playSound('ui');const s = document.getElementById('profile-screen');s.style.opacity = '1';s.style.display='flex';document.getElementById('name-screen').style.display='none';document.getElementById('p-name').innerText=playerName;updAvatarDisplay();let totalP=mData.p||0,totalW=mData.w||0,maxB=mData.b||0,rate=totalP>0?Math.floor((totalW/totalP)*100):0;document.getElementById('p-total').innerText=totalP;document.getElementById('p-win').innerText=totalW;document.getElementById('p-rate').innerText=rate+"%";document.getElementById('p-bet').innerText=maxB;const rEl=document.getElementById('p-rate');if(rate>=50)rEl.style.color="#00ff00";else if(rate>=30)rEl.style.color="#ffaa00";else rEl.style.color="#ff3333"};window.closeProfile=()=>{triggerVib('ui');playSound('ui');const s=document.getElementById('profile-screen');gsap.to(s,{opacity:0,duration:0.2,onComplete:()=>s.style.display='none'})};window.openNamePopup=()=>{triggerVib('ui');document.getElementById('profile-screen').style.display='none';const s = document.getElementById('name-screen');s.style.opacity = '1';s.style.display='flex';document.getElementById('name-input').focus()};window.saveName=()=>{const n=document.getElementById('name-input').value;if(n&&n.trim().length>0){playerName=n.toUpperCase().substring(0,12);saveData();returnToProfile()}else{openCustomModal("INVALID","Please enter a valid name!",false,null)}};window.skipName=()=>{returnToProfile()};function returnToProfile(){triggerVib('ui');document.getElementById('name-screen').style.display='none';window.openProfile()}function createTrail(e){if(Math.random()>0.3)return;const d=document.createElement('div');d.className='trail-dot';let x=e.clientX||(e.touches&&e.touches[0].clientX),y=e.clientY||(e.touches&&e.touches[0].clientY);d.style.left=x+'px';d.style.top=y+'px';document.body.appendChild(d);gsap.to(d,{y:y+20,opacity:0,scale:0.5,duration:0.8,onComplete:()=>d.remove()})}

// UPDATED PLAY FUNCTION FOR ROTATING RC LOGOS
window.play=async()=>{if(coin<bet)return openCustomModal("NO MONEY","Not enough coins to play!",false,null);if(bet<200)return openCustomModal("LOW BET","Minimum Bet is 200!",false,null);triggerVib('ui');playSound('ui');coin-=bet;checkMissionReset();mData.p++;if(mData.b<bet)mData.b=bet;saveData();checkNotif();updUI();locked=!0;document.getElementById('ctrls').style.display='none';const c=cups.length;let n=Math.floor(Math.random()*c);if(n===lastWin)n=(n+1+Math.floor(Math.random()*(c-1)))%c;winCup=cups[n];ball.visible=!0;ball.position.set(winCup.position.x,0.35,winCup.position.z);await gsap.to(winCup.position,{y:3,duration:0.7,ease:"power2.out"});await new Promise(r=>setTimeout(r,400));await gsap.to(winCup.position,{y:0,duration:0.5,ease:"bounce.out"});ball.visible=!1;document.getElementById('msg').innerText="FOCUS!";let cl=Math.min(lev,15),md=0.8-(cl*0.03);if(bet>10000)md-=0.05;if(md<0.3)md=0.3;let ms=8+Math.min(lev,8);triggerVib('bump');if(snd.shuffle){snd.shuffle.volume=volConfig.shuffle;snd.shuffle.play().catch(e=>{})}for(let i=0;i<ms;i++){if(document.getElementById('ui').style.display==='none')break;let a=Math.floor(Math.random()*c),b=Math.floor(Math.random()*c);while(a===b)b=Math.floor(Math.random()*c);if(i%3===0||Math.random()>0.6){a=cups.indexOf(winCup);do{b=Math.floor(Math.random()*c)}while(a===b)}let v=(Math.random()*0.08)-0.04,cs=md+v;
// ROTATE RC LOGOS BASED ON SWAP SPEED
cups.forEach(g=>{gsap.to(g.userData.logo.rotation, {y: g.userData.logo.rotation.y + Math.PI*2, duration: cs, ease: "none"})});
await Promise.all([gsap.to(cups[a].position,{x:cups[b].position.x,duration:cs,ease:"power2.inOut"}),gsap.to(cups[a].position,{z:3.5,duration:cs/2,yoyo:!0,repeat:1,ease:"power1.inOut"}),gsap.to(cups[b].position,{x:cups[a].position.x,duration:cs,ease:"power2.inOut"}),gsap.to(cups[b].position,{z:-3.5,duration:cs/2,yoyo:!0,repeat:1,ease:"power1.inOut"})])}if(snd.shuffle){snd.shuffle.pause();snd.shuffle.currentTime=0}if(document.getElementById('ui').style.display!=='none'){locked=!1;document.getElementById('msg').innerText="PICK CUP!"}};async function tap(e){if(locked)return;const r=ren.domElement.getBoundingClientRect(),m=new THREE.Vector2(((e.clientX-r.left)/r.width)*2-1,-((e.clientY-r.top)/r.height)*2+1),ray=new THREE.Raycaster();ray.setFromCamera(m,cam);const h=ray.intersectObjects(cups,!0);if(h.length){let o=h[0].object;while(o.parent!==sc)o=o.parent;locked=!0;triggerVib('lift');playSound('lift');ball.position.set(winCup.position.x,0.35,winCup.position.z);ball.visible=!0;await gsap.to(o.position,{y:3.5,duration:0.6,ease:"back.out(1.2)"});if(o===winCup){triggerVib('win');playSound('win');mData.w++;let wa=bet*2;addCurrencySmoothly('coin', wa);lev++;lastWin=cups.indexOf(winCup);checkUnlocks();saveData();checkNotif();updUI();document.getElementById('wLine3').innerText="+"+wa+" üí∞";window.openPopup('win');gsap.fromTo("#wLine1",{y:-100,opacity:0},{y:0,opacity:1,duration:0.6});gsap.fromTo("#trp",{scale:0,rotateY:-180},{scale:1,rotateY:0,duration:1})}else{triggerVib('lose');playSound('wrong');currentReviveCost=Math.floor(bet*0.25);if(currentReviveCost<50)currentReviveCost=50;document.getElementById('reviveBtn').innerText=`REVIVE ‚Ä¢ ${currentReviveCost}üí∞`;window.openPopup('lose')}}}
function btnAnim(el){triggerVib('ui');playSound('ui');gsap.fromTo(el,{scale:0.9},{scale:1,duration:0.2})}
window.resume=()=>{triggerVib('ui');locked=!0;if(trophyAnim)trophyAnim.kill();document.getElementById('win').style.display='none';document.getElementById('lose').style.display='none';document.getElementById('ctrls').style.display='flex';if(cups.length!==getCupCount()){mkCups()}else{let sp=(cups.length===4)?2.8:(cups.length===5?2.6:3.5);cups.forEach((c,i)=>{let tx=(i-(cups.length-1)/2)*sp;gsap.to(c.position,{x:tx,z:0,y:0,duration:0.5})})}document.getElementById('msg').innerText="READY?";if(coin<bet){bet=coin>200?Math.floor(coin/100)*100:200;document.getElementById('btnPlay').innerText=`BET ${bet} üí∞`}};
window.revive=()=>{triggerVib('ui');if(coin>=currentReviveCost){coin-=currentReviveCost;saveData();updUI();document.getElementById('lose').style.display='none';locked=!1;document.getElementById('msg').innerText="PICK AGAIN!"}else{openCustomModal("NO FUNDS",`Need ${currentReviveCost} Coins!`,false,null)}};
function updUI(){document.getElementById('cn').innerText=coin;document.getElementById('dm').innerText=diamonds;document.getElementById('lv').innerText=lev;document.getElementById('menu-coin-val').innerText=coin;document.getElementById('menu-diamond-val').innerText=diamonds;updAvatarDisplay()}
function updAvatarDisplay(){const av=avatars[avatarId]||avatars[0];const els=[document.getElementById('p-avatar-display'),document.querySelector('#btnProfile')];els.forEach(el=>{if(el){el.innerHTML = `<img src="${av.img}" style="width:100%; height:100%; object-fit:cover; border-radius:50%;">`;el.style.background=av.c;if(el.id==='p-avatar-display'){el.style.border="2px solid "+(av.id===0?'#fff':'#ffd700')}else{el.style.border="2px solid #00ccff"}}})}
function setCam(){const a=window.innerWidth/window.innerHeight;if(a<1){cam.position.set(0,38,55)}else{cam.position.set(0,25,45)}cam.lookAt(0,-1,0)}
function animate(){requestAnimationFrame(animate);ren.render(sc,cam)}
function loadData(){const d=localStorage.getItem('royalCupsData_v7');if(d){try{const p=JSON.parse(d);coin=p.c;diamonds=p.dm||0;lev=p.l;skinIdx=p.si||0;if(p.s){skins.forEach((s,i)=>{if(i<p.s.length)s.own=!!p.s[i]})}if(p.d)dailyData=p.d;if(p.m)mData=p.m;if(p.vib!==undefined)volConfig.vib=p.vib;if(p.pName)playerName=p.pName;if(p.aid!==undefined)avatarId=p.aid;if(p.oAv)ownedAvatars=p.oAv}catch(e){}}}
function saveData(){const d={c:coin,dm:diamonds,l:lev,si:skinIdx,s:skins.map(s=>s.own?1:0),d:dailyData,m:mData,vib:volConfig.vib,pName:playerName,aid:avatarId,oAv:ownedAvatars};localStorage.setItem('royalCupsData_v7',JSON.stringify(d))}
function simulateLoading(){let p=0;const b=document.getElementById('bar-fill'),t=document.getElementById('loader-text'),l=document.getElementById('loader'),f=document.getElementById('flash'),bt=document.querySelector('.bar-track'),hw=document.getElementById('bar-head-wrap');let ip=false,p65=false,p80=false;function createLoaderSpark(){if(Math.random()>0.3){const s=document.createElement('div');s.className='spark';s.style.right=(Math.random()*20-10)+'px';s.style.top=(Math.random()*30-5)+'px';hw.appendChild(s);gsap.to(s,{x:-80-Math.random()*60,y:(Math.random()*60-30),opacity:0,duration:0.6,onComplete:()=>s.remove()})}}
function loop(){if(!isOnline){requestAnimationFrame(loop);return}if(p>=100){const m=document.getElementById('menu');m.style.display='flex';m.style.opacity='1';document.getElementById('ui').style.display='none';if(ren&&cam)ren.render(sc,cam);setTimeout(()=>{f.style.display='block';f.style.opacity='1';f.style.animation='flashIn 1s forwards';l.style.opacity='0';setTimeout(()=>{l.style.display='none';f.style.display='none'},800)},500);return}if(!ip){p+=(Math.random()*0.35)+0.1;createLoaderSpark();if(p>=65&&!p65){ip=!0;p65=!0;p=65;bt.classList.add('track-warning');setTimeout(()=>{bt.classList.remove('track-warning');ip=!1;requestAnimationFrame(loop)},2000);return}else if(p>=80&&!p80){ip=!0;p80=!0;p=80;bt.classList.add('track-warning');setTimeout(()=>{bt.classList.remove('track-warning');ip=!1;requestAnimationFrame(loop)},1500);return}}let dp=Math.floor(p);if(dp>100)dp=100;b.style.width=dp+'%';t.innerText=dp+'%';requestAnimationFrame(loop)}requestAnimationFrame(loop)}simulateLoading();setTimeout(()=>{try{if(typeof THREE!=='undefined'&&typeof gsap!=='undefined'){init()}else{}}catch(e){}},100);
window.openAvatarSelect=()=>{triggerVib('ui');playSound('ui');document.getElementById('profile-screen').style.display='none';const s=document.getElementById('avatar-screen');s.style.opacity = '1';s.style.display='flex';const grid=document.getElementById('avatar-grid-container');grid.innerHTML='';avatars.forEach(av=>{const d=document.createElement('div');d.className='avatar-item'+(av.id===avatarId?' selected':'');d.style.background=av.c;const isOwned=ownedAvatars.includes(av.id);let content=`<img src="${av.img}" style="width:100%; height:100%; object-fit:cover;">`;if(!isOwned){content+=`<div class="avatar-lock">üîí<div class="av-price">${av.p}üíé</div></div>`}d.innerHTML=content;d.onclick=()=>{if(isOwned){avatarId=av.id;triggerVib('ui');saveData();updAvatarDisplay();closeAvatarSelect()}else{if(diamonds>=av.p){openCustomModal("BUY AVATAR?",`Unlock for ${av.p} Diamonds?`,true,()=>{diamonds-=av.p;ownedAvatars.push(av.id);avatarId=av.id;playSound('purchase');saveData();updUI();updAvatarDisplay();closeAvatarSelect()})}else{openCustomModal("NO DIAMONDS",`Need ${av.p} Diamonds!`,false,null)}}};grid.appendChild(d)})};window.closeAvatarSelect=()=>{triggerVib('ui');playSound('ui');document.getElementById('avatar-screen').style.display='none';window.openProfile()};
window.openCustomModal=(title,msg,isConfirm,callback)=>{const m=document.getElementById('custom-modal');document.getElementById('modal-title').innerText=title;document.getElementById('modal-msg').innerText=msg;const cBtn=document.getElementById('modal-confirm-btn');const ccBtn=m.querySelector('.cancel');if(!isConfirm){ccBtn.style.display='none';cBtn.innerText="OK";cBtn.onclick=()=>{closeModal()}}else{ccBtn.style.display='block';cBtn.innerText="CONFIRM";cBtn.onclick=()=>{closeModal();if(callback)callback()}}m.style.display='flex';requestAnimationFrame(()=>{m.style.opacity=1;m.querySelector('.modal-box').style.transform='scale(1)'})};window.closeModal=()=>{const m=document.getElementById('custom-modal');m.style.opacity=0;m.querySelector('.modal-box').style.transform='scale(0.8)';setTimeout(()=>{m.style.display='none'},200)};
</script>
<!-- ADSTERRA SOCIAL BAR START -->
<script src="https://pl28561406.effectivegatecpm.com/fa/2f/16/fa2f16e47121f950604cceca71f91f89.js"></script>
<!-- ADSTERRA SOCIAL BAR END -->
</body></html>